<a id="idup"></a>
<section id="basic-form-layouts">
	<div class="row">
		<div class="col-md-3 mt-4" *ngIf="selectedUser._id">
      <h5>Clinic: {{selectedUser.userName}}</h5>
    </div>
    <div class="col-md-6">
      <div class="form-group">
        <label for="countrybirth">Select Clinic</label>
        <select id="countrybirth" name="countrybirth" class="form-control"  [(ngModel)]="selectedUser" (ngModelChange)="onChangeUser($event)">
          <option *ngFor="let user of users" [ngValue]="user"> Name: {{user.userName}} Email: {{user.email}}</option> <!--{{user._id}}-->
        </select>
      </div>
    </div>
		{{users.length}}
		<!--<div class="col-md-12">
			<span *ngFor="let user of users">"{{user.userName}}" <{{user.email}}>; ({{user.lang}}) </span>
		</div>-->
		<div class="col-md-3 mt-4"><span id="content"></span></div>
  </div>
	<div class="row">
		<div class="col-md-12 mt-2" *ngIf="selectedPatient.patientName">
      <h5>{{'diagnosis.Case' | translate }}: {{selectedPatient.patientName}} <a class="font-small-3 float-right" href="javascript:void(0)" (click)="changePatient(contentChangePatient)">{{'diagnosis.Change case' | translate }}</a></h5>
			<a *ngIf="activeTittleMenu == 'Workbench'" class="font-small-3" href="javascript:void(0)" (click)="showPanelFeedback(contentFeedback)">{{tittleNotesAndConclusion}}</a>
    </div>
		<div class="col-md-12 mt-2"  *ngIf="!selectedPatient.patientName">
      <div class="form-group">
        <label for="countrybirth">{{'diagnosis.Select case' | translate }}</label>
        <select id="countrybirth" name="countrybirth" class="form-control"  [(ngModel)]="selectedPatient" (ngModelChange)="onChangePatient($event)">
          <option *ngFor="let onepatient of patients" [ngValue]="onepatient">{{onepatient.patientName}}</option>
        </select>
      </div>
    </div>
  </div>
</section>
<section id="basic-form-layouts" style="margin-top:1em;" *ngIf="selectedPatient.patientName">
	<div class="row">

		<div lass="col-md-12" style="margin-bottom:1em;" *ngIf="activeTittleMenu != 'Workbench'">
			<span (click)="toggleMenu()" class="chat-app-sidebar-toggle ft-align-justify font-large-1 mr-2 d-none d-block d-sm-block d-md-none"></span>
			<div class="chat-sidebar d-none d-sm-none d-md-block d-lg-block">
				<a id="idShowPanelSymptoms" style="pointer-events: none;cursor: default;" class="d-inline-block inactiveLink list-group-item bg-blue-grey bg-lighten-5 border-bottom-primary border-bottom-2" (click)="SetActive($event, 'panelSymptoms')">
						Step 1: {{tittleSymptoms}} <!--<i *ngIf="activeTittleMenu!='Symptoms'" class="pull-right fa fa-check"></i>-->
				</a><a id="idShowPanelGenes" style="pointer-events: none;cursor: default;" class="d-inline-block inactiveLink list-group-item" (click)="SetActive($event, 'panelGenes')">
						Step 2: {{tittleGenes}} <!--<i *ngIf="activeTittleMenu!='Symptoms' && activeTittleMenu!='Genes'" class="pull-right fa fa-check"></i>-->
				</a><a id="idShowPanelWorkbench" style="pointer-events: none;cursor: default;" class="d-inline-block inactiveLink list-group-item" (click)="SetActive($event, 'PanelWorkbench')">
						{{tittleWorkbench}}
				</a>
			</div>
		</div>
		<div class="col-md-12">
				<div *ngIf="activeTittleMenu == 'Symptoms'">
					<div class="row" *ngIf="!loading && phenotype.data.length>0">
						<div class="col-md-3 p-0">
							<ng-template #rt let-r="result" let-t="term">
								{{ r.name}}
							</ng-template>
							<div>
							<input #input class="input" type="text" class="form-control" [(ngModel)]="modelTemp" [ngbTypeahead]="searchSymptom" [resultTemplate]="rt" [inputFormatter]="formatter1" placeholder="{{'diagnosis.Search for symptoms' | translate }}" (selectItem)="selected($event)"/>
							</div>
						</div>
						<div class="col-md-9 p-0">
							<button *ngIf="!loadingHpoExtractor && resultTextNcr!='' && medicalText== ''" type="button" class="btn btn-flat btn-primary" style="float:right;" (click)="showPanelSymptomsNcr(contentSymptomsNcr)">{{'diagnosis.Edit last extraction' | translate }}</button>
							<button type="button" class="ml-1 mb-0 btn btn-raised btn-primary" (click)="showPanelAddTextSymptoms(contentAddTextSymptoms)">{{'diagnosis.Input or upload a medical record' | translate }}</button>
						</div>
					</div>
					<div class="center-elements" *ngIf="loading">
						<div><p class="centerSpinner"><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p></div>
					</div>
					<div class="row" *ngIf="!loading">
						<div class="mt-2 card card-body col-md-12" *ngIf="phenotype.data.length>0">
							<div class="row">
								<div class="col-md-12">
									{{phenotype.data.length}} {{'diagnosis.Symptoms' | translate }}
								</div>
								<table class="col-md-12 table text-center">
									<thead>
										<tr>
											<th>{{'generics.Name' | translate }}</th>
											<!--<th>Importance</th>-->
											<th>{{'generics.Delete' | translate }}</th>
										</tr>
									</thead>
									<tbody>
										<tr *ngFor="let hpo of phenotype.data ; let i = index">
											<td style="padding:0;"><a href="https://monarchinitiative.org/phenotype/{{hpo.id}}" target="_blank">{{hpo.name}}</a></td>
											<!--<td>
												<select id="importance" name="importance" [(ngModel)]="hpo.importance">
													<option value="0">None</option>
													<option value="0.5">Low</option>
													<option value="1">Normal</option>
													<option value="1.5">High</option>
												</select>
											</td>-->
											<td>
												<a class="danger" data-original-title="" title="" (click)="confirmDeletePhenotype(i)">
													<i class="ft-x"></i>
												</a>
											</td>
										</tr>
									</tbody>
								</table>
								<div class="col-md-12 center-elements">
									<button type="button" (click)="continueToGenes()" class="btn btn-raised btn-primary pull-right">{{'generics.Next' | translate }}</button>
								</div>
							</div>
						</div>
						<div *ngIf="phenotype.data.length==0" [ngClass]="(phenotype.data.length==0)?'w-75':'col-md-6 mt-2'">
							<div class="card" style="margin-top:0px;">
								<div class="card-header">
								</div>
								<div class="card-body">
									<div class="px-3 mb-3">
										<div class="w-100 p-1">
											<span class="font-medium-2">{{'generics.Option' | translate }} 1</span>
										</div>

										<ng-template #rt let-r="result" let-t="term">
											{{ r.name}}
										</ng-template>
										<div class="form-group">
										<input #input class="input" type="text" class="form-control mb-3" [(ngModel)]="modelTemp" [ngbTypeahead]="searchSymptom" [resultTemplate]="rt" [inputFormatter]="formatter1" placeholder="{{'diagnosis.Search for symptoms' | translate }}" (selectItem)="selected($event)"/>
										</div>
									</div>
									<div class="card-body px-3">
										<div class="w-100 p-1">
											<span class="font-medium-2">{{'generics.Option' | translate }} 2</span>
											<p>
												<small class="text-muted">{{'diagnosis.MsgExtractorField' | translate }} </small>
											</p>
										</div>
										<button id="openModalSymptomsNcrButton" [hidden]="true" (click)="showPanelSymptomsNcr(contentSymptomsNcr)">.</button>
										<form class="form" (ngSubmit)="onSubmitToExtractor()" #f="ngForm">
											<div class="form-body">
												<div class="row">
													<div class="col-md-12">
														<div class="form-group">
															<label class="pull-right mb-0 btn btn-flat btn-primary" style="text-transform: none;letter-spacing: 0px;cursor: pointer;">
																	{{'diagnosis.MsgUploadFileType' | translate }} <input type="file" (change)="onFileChangePDF($event)" style="display: none;">
															</label>
															<textarea class="form-control autoajustable" style="width:100%;height:30vh;max-height: 30vh;" [(ngModel)]="medicalText"  name="medicalText" placeholder="{{'phenotype.HPO phenotype extractor placeholder' | translate }}"></textarea>
															<a *ngIf="medicalText.trim().length > 0" class="btn btn-outline-danger mb-0 mt-1" (click)="deleteText()" href="javascript:void(0)"><i class="fa fa-trash"></i></a>
															<span *ngIf="parserObject.file" class="pull-right">{{'parser.msgOcrInline' | translate }}: <a (click)="parserObject.parserStrategy='OcrInline'; callParser()" href="javascript:void(0)">{{'parser.Advanced extraction' | translate }}</a></span>
														</div>
													</div>
													<div class="col-md-12 center-elements">
														<button *ngIf="!loadingHpoExtractor" type="button" type="submit" [disabled]="medicalText.trim().length <= 5" class="mt-2 font-large-1 btn btn-primary btn-raised">{{'phenotype.Get symptoms' | translate }}</button>
														<button *ngIf="!loadingHpoExtractor && resultTextNcr!='' && medicalText== ''" type="button" class="btn btn-flat btn-primary" (click)="showPanelSymptomsNcr(contentSymptomsNcr)">{{'diagnosis.Edit last extraction' | translate }}</button>
													</div>
													<div class="row col-md-12 center-elements">
															<p class="col-md-12 centerSpinner" *ngIf="loadingHpoExtractor"><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
													</div>
												</div>
											</div>
										</form>
									</div>
									<div class="col-md-12 center-elements" *ngIf="phenotype.data.length>0">
										<button type="button" (click)="continueToGenes()" class="btn btn-raised btn-primary pull-right">{{'generics.Next' | translate }}</button>
									</div>
								</div>
							</div>
						</div>
						</div>
					</div>
				<div *ngIf="activeTittleMenu == 'Genes'">
					<div class="row" *ngIf="!loadingGeno">
						<div class="col-md-12">
							<div class="card" style="margin-top:0px;">
								<div class="card-header">
								</div>
								<div class="card-body">
									<div class="px-3">
										<div class="col-md-12" *ngIf="filename==''">
	                    <span class="font-medium-2">{{'diagnosis.Use the power of genes' | translate }}</span>
	                    <p><span class="font-small-2">{{'diagnosis.Genetic information from patient ...' | translate }}</span></p>
	                    <!--<p *ngIf="filename!=''">File: {{filename}} <a class="danger" data-original-title="" title="" (click)="deletefilename()"><i class="ft-x"></i></a></p>-->
	                    <div class="center-elements">
	                      <label *ngIf="!uploadingGenotype && !isApp && !preparingFile" class="btn btn-raised btn-primary">
	                          {{'genotype.Upload VCF' | translate }} <input type="file" (change)="onFileChangeVCF($event)" accept=".vcf, .vcf.gz" style="display: none;">
	                      </label>
	                      <label *ngIf="!uploadingGenotype && isApp && !preparingFile" class="btn btn-raised btn-primary">
	                          {{'genotype.Upload VCF' | translate }} <input type="file" (change)="onFileChangeVCF($event)" style="display: none;">
	                      </label>
												<p *ngIf="preparingFile">
													<small class="d-block">{{'generics.Preparing to upload' | translate }}</small>
													<i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i>
												</p>
	                      <h4 *ngIf="uploadingGenotype" class="center-elements">{{'generics.Upload Progress' | translate }}: {{uploadProgress | async}}%</h4>

												<p><button type="button" class="btn btn-raised btn-danger" (click)="continueAndCallPhenolyzer()">{{'diagnosis.If you do not have VCF, continue!' | translate }}</button></p>


	                    </div>
	                  </div>
										<div class="col-md-12" *ngIf="filename!='' && filesOnBlob==''">
											<div *ngIf="!uploadingGenotype && uploaded" class="center-elements">
												<a class="btn btn-raised btn-primary" href="javascript:void(0)" (click)="callExomizerSameVcf()">Launch</a>
												<a class="font-small-3 d-block" href="javascript:void(0)" (click)="changeSettingsExomiser(contentSettingsExomiser)">Advanced Exomiser {{'profile.Settings' | translate }}</a>
											</div>
										</div>
										<div class="col-md-12" *ngIf="filename!='' && filesOnBlob!='' && uploadingGenotype">
											<button type="button" class="btn btn-raised btn-danger" (click)="continueDiagnosis()">{{'diagnosis.Continue with the previously saved information' | translate }}</button>
										</div>
										<div class="col-md-12 center-elements mt-4" *ngIf="filename!='' && uploadingGenotype && filesOnBlob==''">
				              <p ><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
				              <small class="mt-2" *ngIf="filename!=''">{{'diagnosis.Gene ranking process is running in background. This process can take a few minutes' | translate }}</small>
				              <small class="d-block" *ngIf="filename!=''">{{'generics.Please wait' | translate }}</small>
											<button type="button" class="btn btn-raised btn-danger mt-2" (click)="cancelExomiser('wizard')">{{'generics.Cancel' | translate }}</button>
				            </div>
										<div class="col-md-12" *ngIf="filename!='' && filesOnBlob!='' && !uploadingGenotype">
											<p ><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
										</div>
										<div>
											<button type="button" class="btn btn-raised btn-danger" (click)="backToSymtoms()">{{'diagnosis.Back to symptoms' | translate }}</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-12 center-elements" *ngIf="loadingGeno">
						<p ><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
					</div>
				</div>
			</div>
			<button id="openModalButton" [hidden]="true" (click)="showPanelDiagnosis(contentRelatedConditions)">.</button>
			<div class="col-md-12">
				<div *ngIf="activeTittleMenu == 'Workbench'">
					<div class="row"> <!--<div class="row" *ngIf="!loading">-->
						<div class="col-md-7 content-sub-header">
							<div class="card-block">
		            <ngb-tabset #t="ngbTabset">
		              <ngb-tab id="tabSymptoms">
										<ng-template ngbTabTitle>
									     <div><span>{{tittleSymptoms}}</span></div>
									  </ng-template>
		                <ng-template ngbTabContent>
											<!--<button type="button" class="btn btn-outline-primary btn-lg btn-block btn-round" (click)="showPanelSelectFromList()">{{'generics.Select' | translate }}</button>-->
											<!--INICIO paneles contenido-->
											{{'diagnosis.Phenotype quality' | translate }}: {{numberOfSymptoms}}
											<p *ngIf="phenotype.data.length<2"><ngb-progressbar type="danger" value="{{numberOfSymptoms}}" [striped]="false" [animated]="true" [max]="12">{{'diagnosis.Poor' | translate }}!</ngb-progressbar></p>
											<p *ngIf="phenotype.data.length>=2 && phenotype.data.length<5"><ngb-progressbar  type="warning" value="{{numberOfSymptoms}}" [striped]="false" [animated]="true" [max]="12">{{'diagnosis.Low' | translate }}</ngb-progressbar></p>
											<p *ngIf="phenotype.data.length>=5 && phenotype.data.length<10"><ngb-progressbar type="info" value="{{numberOfSymptoms}}" [striped]="false" [animated]="true" [max]="12">{{'diagnosis.Medium' | translate }}</ngb-progressbar></p>
											<p *ngIf="phenotype.data.length>10"><ngb-progressbar type="success" value="{{numberOfSymptoms}}" [striped]="false" [animated]="true" [max]="12">{{'diagnosis.High' | translate }}</ngb-progressbar></p>
											<div class="card-block" *ngIf="!loadingSymptoms && !sending && (phenotypeCopy.data.length != phenotype.data.length || checksChanged)">
													<ngb-alert type="warning" [dismissible]="false">
															{{'generics.You have unsaved changes' | translate }}
															<button type="button" class="pull-right btn btn-sm btn-raised btn-raised btn-primary" (click)="saveSymptomsToDb()"><i class="fa fa-check-square-o"></i> {{'generics.Save' | translate }} changes</button>
													</ngb-alert>
											</div>
											<div id="panelSelectFromList">
												<div class="card col-md-12">
													<div class="card-header">
														<p *ngIf="hasGen">GEN: {{geneName}}</p>
														<div class="d-inline-block" >
															<button type="button" *ngIf="filesOnBlob !=''" class="btn-sm btn-raised btn-primary" (click)="editDiagnosis()">{{'diagnosis.Explore more symptoms' | translate }}</button>
															<button *ngIf="filesOnBlob =='' && filePhenolyzerOnBlob!=''" type="button" class="btn-sm btn-raised btn-primary" (click)="exploreMoreSymptomsPhenolyzer()">{{'diagnosis.Explore more symptoms' | translate }}</button>
															<button type="button" class="btn-sm btn-raised btn-primary" (click)="addSymptomsManual(contentAddSymptomsManual)">{{'diagnosis.Add symptoms' | translate }}</button>
															<button type="button" class="ml-1 mb-0 btn-sm btn-raised btn-primary" (click)="showPanelAddTextSymptoms(contentAddTextSymptoms)">{{'diagnosis.Input or upload a medical record' | translate }}</button>
														</div>
														<div class="pull-right" ><!--*ngIf="phenotype.data.length>0"-->
															<a href="javascript:void(0)" style="padding: 0.25rem 0.5rem;" class="font-small-3 float-right changeviewboton" (click)="changeView1()">{{'diagnosis.Change View' | translate }}</a>
														</div>
													</div>
													<div class="card-body" *ngIf="phenotype.data.length > 0">
														<div class="px-3">
															<div class="row">
																<div class="col-md-12">
																	<div class="row col-md-12">
																		<div class="col-sm-12 col-md-6 col-lg-4" *ngFor="let symptom of phenotype.data; let i = index" >
																			<div *ngIf="symptom.checked" class="card border border-success p-1" style="cursor: pointer;background-color: #E2F8F0;min-height: 5em;" (click)="checkChange(); symptom.checked=!symptom.checked">
																			 <input type="checkbox" hidden name="categories{{i}}" #categories="ngModel" value="{{symptom.name}}" [(ngModel)]="symptom.checked" />
																			 <div>
																				 <i *ngIf="!symptom.new" title="{{'generics.Saved' | translate }}" class="pull-right fa fa-check"> </i><i *ngIf="symptom.new" title="{{'generics.Not saved' | translate }}" class="pull-right fa fa-times"> </i>
																				 <a (click)="openLinkMonarch(symptom.id, $event)" href="javascript:void(0)" title="{{symptom.def}}. {{symptom.comment}} " >{{symptom.name}}</a>
																			 </div>
																		 </div>
																		 <div *ngIf="!symptom.checked" class="card border border-danger p-1" style="cursor: pointer;background-color: #FFEBED;min-height: 5em;" (click)="checkChange(); symptom.checked=!symptom.checked">
																			<input type="checkbox" hidden name="categories{{i}}" #categories="ngModel" value="{{symptom.name}}" [(ngModel)]="symptom.checked" />
																			<div><a (click)="openLinkMonarch(symptom.id, $event)" href="javascript:void(0)" title="{{symptom.def}}. {{symptom.comment}} " >{{symptom.name}}</a> <i *ngIf="!symptom.new" class="pull-right fa fa-check"> </i>
																			</div>
																		</div>
																		</div>
																	</div>
																	<div class="row" *ngIf="unknownSymptoms.length>0">
																		<div class="col-md-12">
																			<h4>{{'diagnosis.Non observed symptoms' | translate }}</h4>
																		</div>
																		<div class="col-md-3" *ngFor="let symptom of unknownSymptoms; let j = index" >
																			<div class="card border border-yellow p-1" style="cursor: pointer;background-color: #F9FBE7;min-height: 5em;" (click)="addSymptomToPhenotype(symptom, j);">
																			 <input type="checkbox" hidden name="categories{{i}}" #categories="ngModel" value="{{symptom.name}}" [(ngModel)]="symptom.checked" />
																			 <div>
																				 <i *ngIf="!symptom.new" title="{{'generics.Saved' | translate }}" class="pull-right fa fa-check"> </i><i *ngIf="symptom.new" title="{{'generics.Not saved' | translate }}" class="pull-right fa fa-times"> </i>
																				 <a (click)="openLinkMonarch(symptom.id, $event)" href="javascript:void(0)" title="{{symptom.def}}. {{symptom.comment}} " >{{symptom.name}}</a>
																			 </div>
																		 </div>
																		</div>
																	</div>
																 </div>
															</div>
														</div>
													</div>
												</div>
											</div>

											<div id="panelPhenotypeList" style="display:none;" class="row col-md-12">

													<div class="card col-md-12">
														<div class="card-header">
															<p *ngIf="hasGen">GEN: {{geneName}}</p>
															<div class="d-inline-block" >
																<button type="button" *ngIf="filesOnBlob !=''" class="btn-sm btn-raised btn-primary" (click)="editDiagnosis()">{{'diagnosis.Explore more symptoms' | translate }}</button>
																<button *ngIf="filesOnBlob =='' && filePhenolyzerOnBlob!=''" type="button" class="btn-sm btn-raised btn-primary" (click)="exploreMoreSymptomsPhenolyzer()">{{'diagnosis.Explore more symptoms' | translate }}</button>
																<button type="button" class="btn-sm btn-raised btn-primary" (click)="addSymptomsManual(contentAddSymptomsManual)">{{'diagnosis.Add symptoms' | translate }}</button>
															</div>
															<div class="pull-right" ><!--*ngIf="phenotype.data.length>0"-->
																<a href="javascript:void(0)" style="padding: 0.25rem 0.5rem;" class="font-small-3 float-right" (click)="changeView2()">{{'diagnosis.Change View' | translate }}</a>
															</div>
														</div>
														<div class="card-body">
															<div class="px-3">
																<div *ngIf="phenotype.data.length > 0 " class="table-responsive">
																	<table class="table text-center">
																		<thead>
																			<tr>
																				<th>{{'generics.Name' | translate }}</th>
																				<th>{{'generics.Delete' | translate }}</th>
																				<th>{{'generics.Status' | translate }}</th>
																			</tr>
																		</thead>
																		<tbody>
																			<tr *ngFor="let hpo of phenotype.data ; let i = index">
																				<td><a href="https://monarchinitiative.org/phenotype/{{hpo.id}}" target="_blank">{{hpo.name}}</a></td>
																				<td>
																					<a class="danger" data-original-title="" title="" (click)="confirmDeletePhenotype(i)">
																						<i class="ft-x"></i>
																					</a>
																				</td>
																				<td>
																					<span *ngIf="hpo.new" class="badge badge-pill badge-danger mr-1 mt-1">{{'generics.Not saved' | translate }}</span>
																					<span *ngIf="!hpo.new" class="badge badge-pill badge-success mr-1 mt-1">{{'generics.Saved' | translate }}</span>
																				</td>
																			</tr>
																		</tbody>
																	</table>
																	<div class="center-elements">
																		<button type="button" class="btn btn-raised btn-raised btn-warning" (click)="deleteAllSymtoms()">{{'phenotype.Delete all symptoms' | translate }}</button>
																	</div>
																</div>
																<div *ngIf="phenotype.data.length == 0 ">
																	{{'phenotype.No symptoms' | translate }}
																</div>

																<!--<div class="center-elements" *ngIf="!sending">
																	<button type="button" class="btn btn-raised btn-raised btn-primary" (click)="onSubmit()"><i class="fa fa-check-square-o"></i> {{'generics.Save' | translate }}</button>
																</div>-->
																<div class="col-md-12 center-elements" *ngIf="sending">
																	<div><p class="centerSpinner"><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p></div>
																</div>
															</div>
														</div>
													</div>
													<div *ngIf="phenotype.date">
														<small>{{'generics.Saved on' | translate }} {{phenotype.date | date:'yyyy-MM-dd HH:mm a'}}</small>
													</div>


											</div>
										</ng-template>
		              </ngb-tab>
									<ngb-tab>
										<ng-template ngbTabTitle>
											<div (click)="loadHtmlExo()"><span>Exomiser</span></div>
									  </ng-template>
		                <ng-template ngbTabContent>
											<div class="mb-4" *ngIf="!uploadingGenotype">
												<label *ngIf="!uploadingGenotype && !isApp && !preparingFile" class="btn btn-raised btn-primary">
	                          {{'diagnosis.New Vcf' | translate }} <input type="file" (change)="onFileChangeVCF($event)" accept=".vcf, .vcf.gz" style="display: none;">
	                      </label>
	                      <label *ngIf="!uploadingGenotype && isApp && !preparingFile" class="btn btn-raised btn-primary">
	                          {{'diagnosis.New Vcf' | translate }} <input type="file" (change)="onFileChangeVCF($event)" style="display: none;">
	                      </label>
												<p *ngIf="preparingFile">
													<small class="d-block">{{'generics.Preparing to upload' | translate }}</small>
													<i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i>
												</p>
												<button type="button" *ngIf="filename !=''" class="btn btn-raised btn-primary" (click)="selectOldVcf(contentSelectVcf)">{{'diagnosis.Reanalyze' | translate }}</button>
												<button type="button" *ngIf="filesOnBlob !=''" class="btn btn-raised btn-primary" (click)="editDiagnosis()">{{'diagnosis.Explore more symptoms' | translate }}</button>
												<a class="font-small-3 float-right" style="margin-top: 0.5em;" href="javascript:void(0)" (click)="changeSettingsExomiser(contentSettingsExomiser)"> {{'diagnosis.Advanced Settings' | translate }}</a>
												<p *ngIf="filename!=''">{{'diagnosis.File uploaded' | translate }}: {{'generics.Yes' | translate }}</p> <!--{{filename}}-->
												<p *ngIf="urlFileHtmlExomiserBlob!=''"><a href="{{urlFileHtmlExomiserBlob}}" download>Download Exomiser Analysis Results</a></p>
												<p *ngIf="urlFileHtmlExomiserBlob=='' && loadingFileHtmlExomiserBlob"><i class="fa fa-spinner fa-spin fa-fw pink"></i></p>
												<table class="table" *ngIf="infoGenesAndConditionsExomizer.length>0">
								          <thead>
								            <tr>
								              <th>{{'diagnosis.Ranked genes' | translate }}</th>
								              <th>{{'phenotype.Related conditions' | translate }}</th>
								            </tr>
								          </thead>
								          <tbody>
								            <tr *ngFor="let info of infoGenesAndConditionsExomizer ; let i = index">
								              <td>
								                <h3>{{info.name}}</h3>
								              </td>
								              <td *ngIf="info.data.length>0">
								                <p *ngFor="let condition of info.data ; let j = index">
								                  {{condition.condition}}
								                </p>
								              </td>
								              <td *ngIf="info.data.length==0">
								                {{'diagnosis.No known disease' | translate }}
								              </td>
								            </tr>
								          </tbody>
								        </table>
											</div>
											<div class="col-md-12 center-elements mt-4" *ngIf="filename!='' && uploadingGenotype">
					              <p ><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
					              <small class="mt-2" *ngIf="filename!=''">{{'diagnosis.Gene ranking process is running in background. This process can take a few minutes' | translate }}</small>
					              <small class="d-block" *ngIf="filename!=''">{{'generics.Please wait' | translate }}</small>
												<button type="button" class="btn btn-raised btn-danger mt-2" (click)="cancelExomiser('workbench')">{{'generics.Cancel' | translate }}</button>

					            </div>
											<div class="col-md-12 center-elements" *ngIf="filename=='' && uploadingGenotype">
					              <p ><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
					              <h4 *ngIf="uploadingGenotype">{{'generics.Upload Progress' | translate }}: {{uploadProgress | async}}%</h4>
					              <small class="d-block">{{'generics.Please wait' | translate }}</small>

					            </div>
										</ng-template>
		              </ngb-tab>
									<ngb-tab id="tabPhenolyzer">
										<ng-template ngbTabTitle>
											<div><span>Phenolyzer</span></div>
									  </ng-template>
		                <ng-template ngbTabContent>
											<div class="mb-4" *ngIf="!launchingPhenolyzer">
												<button type="button" class="btn btn-raised btn-primary" (click)="launchPhenolyzer()">{{'diagnosis.Launch' | translate }}</button>
												<button *ngIf="filePhenolyzerOnBlob!=''" type="button" class="btn btn-raised btn-primary" (click)="exploreMoreSymptomsPhenolyzer()">{{'diagnosis.Explore more symptoms' | translate }}</button>
												<p *ngIf="filePhenolyzerOnBlob!=''">{{'diagnosis.File uploaded' | translate }}: {{'generics.Yes' | translate }}</p><!--{{filePhenolyzerOnBlob}}-->
												<table class="table" *ngIf="infoGenesAndConditionsPhenolyzer.length>0">
								          <thead>
								            <tr>
								              <th>{{'diagnosis.Ranked genes' | translate }}</th>
								              <th>{{'phenotype.Related conditions' | translate }}</th>
								            </tr>
								          </thead>
								          <tbody>
								            <tr *ngFor="let info of infoGenesAndConditionsPhenolyzer ; let i = index">
								              <td>
								                <h3>{{info.name}}</h3>
								              </td>
								              <td *ngIf="info.data.length>0">
								                <p *ngFor="let condition of info.data ; let j = index">
								                  {{condition.condition}}
								                </p>
								              </td>
								              <td *ngIf="info.data.length==0">
								                {{'diagnosis.No known disease' | translate }}
								              </td>
								            </tr>
								          </tbody>
								        </table>
											</div>
											<div class="col-md-12 center-elements mt-4" *ngIf="launchingPhenolyzer">
					              <p ><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
					              <small class="mt-2">{{'diagnosis.Gene ranking process is running in background. This process can take a few minutes' | translate }}</small>
					              <small class="d-block">{{'generics.Please wait' | translate }}</small>
					            </div>
										</ng-template>
		              </ngb-tab>
		            </ngb-tabset>
		          </div>

							<button id="buttonChangeTab" class="btn btn-outline-primary" [hidden]="true" (click)="t.select('tabSymptoms')">Selected tab with "tabSymptoms" id</button>

							<!--FIN paneles contenido-->

						</div>
						<div class="col-md-5 content-sub-header fijado">
							<h4>{{'diagnosis.Proposed diagnoses' | translate }} <a *ngIf="relatedConditions.length>0 || selectedItemsFilter.length>0" class="font-medium-2 pull-right" href="javascript:void(0)" (click)="getRelatedConditions()">{{'generics.Update' | translate }} </a></h4>
							<a *ngIf="relatedConditions.length==0 && !gettingRelatedConditions && !loadingDiagnosisInfo && selectedItemsFilter.length==0  && !launchingPhenolyzer &&!uploadingGenotype" class="font-medium-2 btn btn-block btn-danger shadow-big-navbar btn-raised" style="height: 100px;padding-top: 35px;vertical-align: middle;" href="javascript:void(0)" (click)="getRelatedConditions()">Calculate</a>
							<div *ngIf="loadingInfoGenes"><p class="centerSpinner">{{'diagnosis.Calculating genes and their score' | translate }} <i class="fa fa-spinner fa-spin fa-fw pink"></i></p></div>
							<div *ngIf="calculatingH29Score"><p class="centerSpinner">{{'diagnosis.Calculating Dx29 score' | translate }} <i class="fa fa-spinner fa-spin fa-fw pink"></i></p></div>
							<div *ngIf="showErrorMsg"><p class="centerSpinner">{{'generics.error try again' | translate }} <button type="button" class="" (click)="getRelatedConditions()"><i class="fa fa-refresh fa-fw pink"></i></button></p></div>
							<div class="row mt-2" *ngIf="relatedConditions.length>0">
								<div class="col-md-6">
									<label class="font-small-3">C1 = {{'diagnosis.Symptoms matches' | translate }}</label>
								</div>
								<div class="col-md-6">
									<label class="font-small-3">C2 = {{'diagnosis.Phenotype score' | translate }}</label>
								</div>
								<div class="col-md-6" *ngIf="this.infoGenesAndConditionsExomizer.length>0 || (this.infoGenesAndConditionsExomizer.length==0 && this.infoGenesAndConditionsPhenolyzer.length>0)">
									<label class="font-small-3">C3 = {{'diagnosis.Gene score' | translate }}</label>
								</div>
								<div class="col-md-6" *ngIf="this.infoGenesAndConditionsExomizer.length>0 || (this.infoGenesAndConditionsExomizer.length==0 && this.infoGenesAndConditionsPhenolyzer.length>0)">
									<label class="font-small-3">Dx29 = {{'diagnosis.Overall score' | translate }}</label>
								</div>
							</div>

							<div class="row col-md-12 mb-1" *ngIf="selectedItemsFilter.length>0 || (this.infoGenesAndConditionsExomizer.length>0 && (relatedConditions.length>0 && !gettingRelatedConditions && !calculatingH29Score && !loadingInfoGenes) || (this.infoGenesAndConditionsExomizer.length==0 && this.infoGenesAndConditionsPhenolyzer.length>0) && (relatedConditions.length>0 && !gettingRelatedConditions && !calculatingH29Score && !loadingInfoGenes))">
								<a class="font-medium-2" href="javascript:void(0)" (click)="setFitersDiseases(contentFilterDiseases)">{{'diagnosis.Filter diseases' | translate }}<span *ngIf="selectedItemsFilter.length>0">: {{selectedItemsFilter.length}} applied filters</span></a>
								<a class="ml-1" *ngIf="selectedItemsFilter.length>0" href="javascript:void(0)" (click)="removeFilters()" title="Remove filters">
									<i class="fa fa-trash red"></i>
								</a>
							</div>

							<div *ngIf="(this.infoGenesAndConditionsExomizer.length>0 && (relatedConditions.length>0 && !gettingRelatedConditions && !calculatingH29Score && !loadingInfoGenes) || (this.infoGenesAndConditionsExomizer.length==0 && this.infoGenesAndConditionsPhenolyzer.length>0) && (relatedConditions.length>0 && !gettingRelatedConditions && !calculatingH29Score && !loadingInfoGenes))">
								<div class="row">
									<div class="offset-md-1 col-md-2">
										<label>{{'generics.Show' | translate }}:</label>
									</div>
									<div class="col-md-2">
										<label class="radio-inline"><input type="radio" name="optradio" value="h29" [(ngModel)]="paramgraph" (change)="onchangeparamgraph()"> Dx29</label>
									</div>
									<div class="col-md-2">
										<label class="radio-inline"><input type="radio" name="optradio" value="matches" [(ngModel)]="paramgraph" (change)="onchangeparamgraph()"> C1</label>
									</div>
									<div class="col-md-2">
										<label class="radio-inline"><input type="radio" name="optradio" value="score" [(ngModel)]="paramgraph" (change)="onchangeparamgraph()"> C2</label>
									</div>
									<div class="col-md-2">
										<label class="radio-inline"><input type="radio" name="optradio" value="scoregenes" [(ngModel)]="paramgraph" (change)="onchangeparamgraph()"> C3</label>
									</div>
								</div>
							<!-- grafica tree de highcharts-->
							<div #containermap style="color: #000000; font-weight: bold" *ngIf="relatedConditions.length>0"></div>
							</div>

							<div *ngIf="!gettingRelatedConditions">
								<ngx-datatable (activate)="onActivate($event, contentSeeSymptomsOfDisease)" *ngIf="relatedConditions.length>0" responsive
					        class="bootstrap fullscreen"
					        [columnMode]="'flex'"
					        [headerHeight]="50"
					        [footerHeight]="50"
					        [rowHeight]="'auto'"
					        [rows]="relatedConditions"
									> <!--[limit]="20"-->
					        <ngx-datatable-column name="{{'generics.Name' | translate }}" prop="name" [flexGrow]="5" [sortable]="false">
					          <ng-template let-value="value" let-row="row" ngx-datatable-cell-template>
											<span *ngIf="value.genes === undefined">
												<span *ngIf="value.infogene !== undefined">
													<!--<a href="{{value.infogene}}" target="_blank" rel="tooltip" title="{{value.infogene}}">{{value.label}}</a> *-->
													{{value.label}} *
												</span>
												<span *ngIf="value.infogene === undefined">
													{{value.label}}
												</span>

											</span>
					            <span *ngIf="value.genes !== undefined">
												<!--<a href="https://monarchinitiative.org/disease/{{value.id}}" target="_blank" rel="tooltip" title="{{value.genes}}">{{value.label | titlecase}}</a>-->
												{{value.label}}
											</span>
											<!--<p *ngIf="value.infoSymptom">
												<a class="btn btn-sm btn-outline-primary btn-fab" href="javascript:void(0)" (click)="changeSymptomsOfDisease(row, contentSeeSymptomsOfDisease)" title="{{'diagnosis.Mark as an unknown symptom' | translate }}">Symptoms</a>
											</p>-->
					          </ng-template>
					        </ngx-datatable-column>
									<ngx-datatable-column name="C1" prop="matches" [flexGrow]="1">
					          <ng-template let-value="value" ngx-datatable-cell-template>
					            {{value.length}}
					          </ng-template>
					        </ngx-datatable-column>
									<ngx-datatable-column name="C2" prop="score" [flexGrow]="1">
					          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
					            {{value}}
					          </ng-template>
					        </ngx-datatable-column>
									<ngx-datatable-column name="C3" prop="scoregenes" [flexGrow]="1" *ngIf="this.infoGenesAndConditionsExomizer.length>0 || (this.infoGenesAndConditionsExomizer.length==0 && this.infoGenesAndConditionsPhenolyzer.length>0)">
					          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
					            {{value}}
					          </ng-template>
					        </ngx-datatable-column>
									<ngx-datatable-column name="Dx29" prop="h29" [flexGrow]="1" *ngIf="this.infoGenesAndConditionsExomizer.length>0 || (this.infoGenesAndConditionsExomizer.length==0 && this.infoGenesAndConditionsPhenolyzer.length>0)">
					          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
											<div *ngIf="row.color">
												<p [ngStyle]="{'background-color': row.color}"><span style="padding: 0.2em;">{{value}}</span></p>
												</div>
											<div *ngIf="!row.color">
						            <p *ngIf="value>=90" style="background-color:#79f659;padding: 0.1em;"><span style="padding: 0.2em;">{{value}}</span></p>
												<p *ngIf="value>=80 && value<90" style="background-color:#6ab093;padding: 0.1em;"><span style="padding: 0.2em;">{{value}}</span></p>
												<p *ngIf="value<80" style="background-color:#5760d3; color: #fff;padding: 0.1em;"><span style="padding: 0.2em;">{{value}}</span></p>
											</div>
					          </ng-template>
					        </ngx-datatable-column>
					      </ngx-datatable>
							<div class="col-md-12" *ngIf="relatedConditions.length>0 && (this.infoGenesAndConditionsExomizer.length>0 || (this.infoGenesAndConditionsExomizer.length==0 && this.infoGenesAndConditionsPhenolyzer.length>0))">
								<label>* No information found in Monarch's MONDO disease database. Consulting genecards instead. The link may not work.
								</label>
							</div>
								<p *ngIf="relatedConditions.length==0"><!--{{'generics.No data' | translate }}--></p>
							</div>

							<div class="col-md-12 center-elements" *ngIf="gettingRelatedConditions">
								<!--<p>
									<button type="button" class="btn btn-outline-primary btn-round" (click)="getRelatedConditions()">{{'diagnosis.Retry Potential Conditions' | translate }}</button>
								</p>-->
								<div><p class="centerSpinner"><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p></div>
							</div>
						</div>

					</div>
				</div>
				<div><span id="content"></span></div>
		</div>
	</div>
</section>


<ng-template #contentRelatedConditions let-c="close" let-d="dismiss" appendTo="body">
		<div class="modal-header container row col-md-12" id="idHeader">
			<div class="col-md-8">
				<h4 class="col-md-8 modal-title">{{'diagnosis.Explore symptoms related to' | translate }}</h4>
				<p style="margin-left:1em;"><b style="font-weight: 700;">{{infoGenesAndConditions[actualPosGen].name}}: {{actualDisease.condition}}</b></p>
			</div>

		</div>
		<div class="modal-body" *ngIf="!loadingSymptomsOfDisease">
			<div class="px-3">
						<div class="card">
							<div class="card-body">
								<div class="container col-md-12"  *ngIf="actualDisease.symptoms">
									{{'diagnosis.Phenotype quality' | translate }}: {{numberOfSymptoms}}
									<p [hidden]="numberOfSymptoms>2"><ngb-progressbar type="danger" value="{{numberOfSymptoms}}" [striped]="false" [animated]="true" [max]="12">{{'diagnosis.Poor' | translate }}!</ngb-progressbar></p>
									<p [hidden]="numberOfSymptoms<=2 || numberOfSymptoms>=5"><ngb-progressbar  type="warning" value="{{numberOfSymptoms}}" [striped]="false" [animated]="true" [max]="12">{{'diagnosis.Low' | translate }}</ngb-progressbar></p>
									<p [hidden]="numberOfSymptoms<5 || numberOfSymptoms>=10"><ngb-progressbar type="info" value="{{numberOfSymptoms}}" [striped]="false" [animated]="true" [max]="12">{{'diagnosis.Medium' | translate }}</ngb-progressbar></p>
									<p [hidden]="numberOfSymptoms<10"><ngb-progressbar type="success" value="{{numberOfSymptoms}}" [striped]="false" [animated]="true" [max]="12">{{'diagnosis.High' | translate }}</ngb-progressbar></p>


									<div class="row"  *ngIf="actualDisease.symptoms.length > 0 ">
									<div class="col-sm-6 col-md-4 col-lg-3" *ngFor="let symptom of actualDisease.symptoms; let i = index" >
										<div *ngIf="symptom.checked=='true'" class="card border border-success p-1" style="cursor: pointer; background-color: #E2F8F0; min-height:8em;" (click)="changeSymptomFalse(i)">
											 <input type="checkbox" hidden name="categories{{i}}" #categories="ngModel" value="{{symptom.name}}" [(ngModel)]="symptom.checked" />
											 <div class="card-body">
												 <div class="d-inline-block" style="width:75%;">
													 <a (click)="openLinkMonarch(symptom.id, $event)" href="javascript:void(0)" title="{{symptom.def}}. {{symptom.comment}} " >{{symptom.name}}</a>
												 </div>
												 <div class="pull-right">
													 <a class="btn btn-outline-primary btn-fab" href="javascript:void(0)" (click)="changeSymptomUnknown(i)" title="{{'diagnosis.Mark as an unknown symptom' | translate }}"><i class="fa fa-question"></i></a>
												 </div>
										 </div>
									 </div>
									 <div *ngIf="symptom.checked=='false'" class="card border border-danger p-1" style="cursor: pointer;background-color: #FFEBED; min-height:8em;" (click)="changeSymptomTrue(i)">
											<input type="checkbox" hidden name="categories{{i}}" #categories="ngModel" value="{{symptom.name}}" [(ngModel)]="symptom.checked" />
											<div class="card-body">
												<div class="d-inline-block" style="width:75%;">
													<a (click)="openLinkMonarch(symptom.id, $event)" href="javascript:void(0)" title="{{symptom.def}}. {{symptom.comment}} " >{{symptom.name}}</a>
												</div>
												<div class="pull-right">
													<a class="btn btn-outline-primary btn-fab" href="javascript:void(0)" (click)="changeSymptomUnknown(i)"  title="{{'diagnosis.Mark as an unknown symptom' | translate }}"><i class="fa fa-question"></i></a>
												</div>
										</div>
									</div>
									<div *ngIf="symptom.checked=='unknown'" class="card border border-yellow p-1" style="cursor: pointer;background-color: #F9FBE7; min-height:8em;">
										 <input type="checkbox" hidden name="categories{{i}}" #categories="ngModel" value="{{symptom.name}}" [(ngModel)]="symptom.checked" />
										 <div>
											 <a (click)="openLinkMonarch(symptom.id, $event)" href="javascript:void(0)" title="{{symptom.def}}. {{symptom.comment}} " >{{symptom.name}}</a>
										 </div>
										 <div class="card-body">
										 <a class="btn btn-outline-danger btn-fab" href="javascript:void(0)" (click)="changeSymptomUnknownToFalse(i)"><i class="fa fa-times"></i></a>
										 <a class="btn btn-outline-success btn-fab" href="javascript:void(0)" (click)="changeSymptomTrue(i)"><i class="fa fa-check"></i></a>
									 </div>
								 </div>
								</div>
								<div *ngIf="actualDisease.symptoms.length == 0 ">
									{{'phenotype.No symptoms' | translate }}
									<p><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
								</div>
							</div>
						</div>
						<div class="container col-md-12"  *ngIf="!actualDisease.symptoms">
							{{'phenotype.No symptoms' | translate }}: {{switchOrigin}} (ORPHA - OMIM)
							<p><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal-body" *ngIf="loadingSymptomsOfDisease">
			<div class="center-elements">
				<div><p class="centerSpinner"><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p></div>
			</div>
		</div>
		<div class="modal-footer"  *ngIf="!loadingSymptomsOfDisease">
			<div class="col-md-12 center-elements">
				<div class="form-actions center">
						<!--<button *ngIf="actualPosGen>0 || actualPosDisease>0" type="button" class="pull-left btn btn-secondary btn-raised" (click)="getPreviousDisease()">{{'generics.Previous' | translate }}</button>-->
						<button *ngIf="globalPosDisease>1" type="button" class="pull-left btn btn-secondary btn-raised" (click)="getPreviousDiseasepo()">{{'generics.Previous' | translate }}</button>
							<button *ngIf="globalPosDisease<sizeOfDiseases" type="button" class="pull-right btn btn-primary btn-raised" (click)="getNextDisease();">{{'generics.Next' | translate }}</button>
						<button type="button" class="btn btn-secondary btn-raised" (click)="finishDiagnosis()">{{'generics.Finish' | translate }}</button>
				</div>
			</div>
		</div>
</ng-template>

<ng-template #contentAddSymptomsManual let-c="close" let-d="dismiss" appendTo="body">
		<div class="modal-header" id="idHeader">
				<h4 class="modal-title">{{'diagnosis.Add symptoms' | translate }}</h4>
		</div>
		<div class="modal-body">
			<ng-template #rt let-r="result" let-t="term">
				{{ r.name}}
			</ng-template>
			<div class="form-group">
			<input #input class="input" type="text" class="form-control mb-3" [(ngModel)]="modelTemp" [ngbTypeahead]="searchSymptom" name="addSymptomsOption1" [resultTemplate]="rt" [inputFormatter]="formatter1" placeholder="{{'diagnosis.Search for symptoms' | translate }}" (selectItem)="selected2($event)"/>
			</div>
			<span class="btn btn-primary btn-sm selected" style="margin-right: 0.5em;" *ngFor="let item of selectedItems">
				<span style="color: black !important;">
					{{item.name}}
					<span class="close-selected" (click)="deleteItem(item)">&nbsp;x</span>
				</span>
			</span>
			<div class="col-md-12 center-elements">
				<button *ngIf="!loadingHpoExtractor" type="button" (click)="addSymptomsOption1()" [disabled]="selectedItems.length == 0" class="btn btn-raised btn-primary">{{'diagnosis.Add symptoms' | translate }}</button>
			</div>
		</div>
		<div class="modal-footer">
			<div class="form-actions center" *ngIf="!sending">
					<button type="button" class="btn btn-secondary btn-raised" (click)="c('Close click')">{{'generics.Close' | translate }}</button>
			</div>
		</div>
</ng-template>
<ng-template #contentChangePatient let-c="close" let-d="dismiss" appendTo="body">
		<div class="modal-header" id="idHeader">
				<h4 class="modal-title">{{'diagnosis.Select case' | translate }}</h4>
		</div>
		<div class="modal-body">
			<select id="countrybirth" name="countrybirth" class="form-control"  [(ngModel)]="selectedPatient" (ngModelChange)="onChangePatient($event)">
				<option *ngFor="let onepatient of patients" [ngValue]="onepatient">{{onepatient.patientName}}</option>
			</select>
		</div>
		<div class="modal-footer">
			<div class="form-actions center" *ngIf="!sending">
					<button type="button" class="btn btn-secondary btn-raised" (click)="c('Close click')">{{'generics.Close' | translate }}</button>
			</div>
		</div>
</ng-template>
<ng-template #contentSettingsExomiser let-c="close" let-d="dismiss" appendTo="body">
		<div class="modal-header" id="idHeader">
				<h4 class="modal-title">Advanced Setting of Exomiser</h4>
				<button type="button" class="close" aria-label="Close" (click)="c('Close click')">
					<span aria-hidden="true">&times;</span>
				</button>
		</div>
		<div class="modal-body" id="settingExomiser">
			<form class="form" #f="ngForm">
				<div class="form-body">
					<div class="row col-md-12">
						<h4 class="form-section col-md-12">Basic fields <i [ngClass]="(showBasicFields==true)?'ft-chevron-down info':'ft-chevron-up info'" (click)="showBasicFields=!showBasicFields"></i></h4>
						<div class="col-md-12 row" *ngIf="!showBasicFields">
							<div class="form-group col-md-12 row">
								<div *ngIf="filesVcf.length>0" class="col-md-9">
											<table class="table text-center table-responsive">
												<thead>
													<tr>
														<th>{{'diagnosis.VCF file' | translate }}</th>
														<th>{{'generics.Options' | translate }}</th>
													</tr>
												</thead>
												<tbody>
													<tr *ngFor="let onefile of filesVcf; let i = index">
														<td *ngIf="onefile.name == filename" style="word-wrap: anywhere;">
															<span *ngIf="filesVcf.length>1" class="badge bg-secondary text-white">Selected</span> {{onefile.name}}
														</td>
														<td *ngIf="onefile.name != filename" style="word-wrap: anywhere;">
															{{onefile.name}}
														</td>
														<td>
															<a *ngIf="onefile.name != filename" class="btn btn-outline-primary" (click)="selectVcfAsDefault(onefile.name);" href="javascript:void(0)">Select</a>
															<a class="btn btn-outline-danger" (click)="deleteVcfFile(onefile.name,i);" href="javascript:void(0)">Delete</a>
															<!--<a class="danger" data-original-title="" title="" (click)="deleteVcfFile(onefile.name,i)">
																<i class="ft-x"></i>
															</a>-->
														</td>
													</tr>
												</tbody>
											</table>
								</div>
								<div class="col-md-3">
									<ng-template #popContent>
										<p>Variant call file containing mutations in the <a href="https://en.wikipedia.org/wiki/Variant_Call_Format" target="_blank">VCF</a> format.</p>
										<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p1.close()">Close</button>
									</ng-template>
									<label for="VcfBlobName" style="display: block;">VCF file <i class="ft-help-circle danger"  style="cursor: pointer;" placement="down" #p1="ngbPopover" [ngbPopover]="popContent" popoverTitle="VCF file"></i></label>
									<span *ngIf="filesVcf.length==0">
										<p *ngIf="filename ==''">{{'generics.No data' | translate }}</p>
										<p *ngIf="filename !=''">{{filename}}</p>
									</span>
									<label *ngIf="!uploadingGenotype && !isApp && !preparingFile" class="btn btn-raised btn-primary">
											{{'genotype.Upload VCF' | translate }} <input type="file" (change)="onFileChangeVCF($event)" accept=".vcf, .vcf.gz" style="display: none;">
									</label>
									<label *ngIf="!uploadingGenotype && isApp && !preparingFile" class="btn btn-raised btn-primary">
											{{'genotype.Upload VCF' | translate }} <input type="file" (change)="onFileChangeVCF($event)" style="display: none;">
									</label>
									<p *ngIf="preparingFile">
										<small class="d-block">{{'generics.Preparing to upload' | translate }}</small>
										<i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i>
									</p>
									<h4 *ngIf="uploadingGenotype">{{'generics.Upload Progress' | translate }}: {{uploadProgress | async}}%</h4>
								</div>
							</div>
						</div>
						<h4 class="form-section col-md-12">Inheritance and pedigrees <i [ngClass]="(showInheritanceAndPedigrees==true)?'ft-chevron-up info':'ft-chevron-down info'" (click)="showInheritanceAndPedigrees=!showInheritanceAndPedigrees"></i></h4>
						<div class="col-md-12 row" *ngIf="showInheritanceAndPedigrees">
							<div class="form-group col-md-6">
								<ng-template #popContent2>
									<p>File containing pedigree information in Linkage pedigree format. Request it to your lab. </p>
									<p>Colunms are: Family ID, Individual ID, Paternal ID</p>
									<p>Maternal ID, Sex (1=male; 2=female; other=unknown), Phenotype (-9 or 0 missing, 1 unaffected, 2 affected). Requires a multisample VCF file with the same individual IDs and a Proband.</p>
									<p>Further reading: <a href="https://gatkforums.broadinstitute.org/gatk/discussion/7696/pedigree-ped-files" target="_blank">GATK forum</a>, <a href="https://www.mv.helsinki.fi/home/tsjuntun/autogscan/pedigreefile.html" target="_blank">Autogscan</a>, <a href="http://zzz.bwh.harvard.edu/plink/data.shtml#ped" target="_blank">Purcell lab @ BWH</a>.</p>
									<p class="mt-2">Example:</p>
									<table style="width:75%" >
									<tr>
										<td>FAM1</td>
										<td>ID1</td>
										<td>0</td>
										<td>0</td>
										<td>1</td>
										<td>1</td>
									</tr>
									<tr>
										<td>FAM1</td>
										<td>ID2</td>
										<td>0</td>
										<td>0</td>
										<td>2</td>
										<td>1</td>
									</tr>
									<tr>
										<td>FAM1</td>
										<td>ID3</td>
										<td>ID1</td>
										<td>ID2</td>
										<td>1</td>
										<td>1</td>
									</tr>
									<tr>
										<td>FAM1</td>
										<td>ID4</td>
										<td>ID1</td>
										<td>ID2</td>
										<td>2</td>
										<td>2</td>
									</tr>
								</table>
								<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p2.close()">Close</button>
							</ng-template>
								<label for="PedBlobName">Ped File <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p2="ngbPopover" [ngbPopover]="popContent2" popoverTitle="Ped File"></i></label>
								<p *ngIf="settingExomizer.PedBlobName">{{settingExomizer.PedBlobName}} <a *ngIf="settingExomizer.PedBlobName && !uploadingPed" class="btn btn-outline-danger mb-0" (click)="deleteDataAndFile();" href="javascript:void(0)"><i class="fa fa-times"></i></a></p>
								<p *ngIf="!uploadingPed && !settingExomizer.PedBlobName">
									<label class="btn btn-outline-primary">
											<i class="fa ft-upload-cloud"></i> <input type="file" (change)="onFileChange($event)" style="display: none;" accept=".ped">
									</label>
								</p>
								<h4 *ngIf="uploadingPed" class="center-elements">{{'generics.Upload Progress' | translate }}: {{uploadProgressPed | async}}%</h4>
							</div>
							<div class="form-group col-md-6" *ngIf="settingExomizer.PedBlobName">
								<ng-template #popContent3>
									<p>ID of case to analyze in PED and VCF files. In the example of PED file provided in the PED description, the proband would be ID4 because she is the only affected individual (this is not necessarily the general case).</p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p3.close()">Close</button></ng-template>
								<label for="Proband">Proband <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p3="ngbPopover" [ngbPopover]="popContent3" popoverTitle="Proband"></i></label>
								<input type="text" id="Proband" class="form-control"  name="Proband" [(ngModel)]="settingExomizer.Proband">
							</div>
							<div class="col-md-12">
								<ng-template #popContent4><p>Functionality to filter variants for being compatible with a given pedigree and a mode of inheritance.</p>
									<p>These filters work well for single individuals and the common case of two parents and a number of children. However, there are limitations when using them for larger pedigrees. For such larger families, the filters lose specificity but not sensitivity. That is, they can fail to filter out less than theoretically possible, but they should not lose any data.</p>
									<p>Please, study <a href="https://jannovar.readthedocs.io/en/master/ped_filters.html" target="_blank">Jannovar documentation</a> prior to modification. Default:</p>
									<table style="width:75%" class="mb-2">
									<tr>
										<td>AUTOSOMAL_DOMINANT</td>
										<td>0.1</td>
									</tr>
									<tr>
										<td>AUTOSOMAL_RECESSIVE_HOM_ALT</td>
										<td>0.1</td>
									</tr>
									<tr>
										<td>AUTOSOMAL_RECESSIVE_COMP_HET</td>
										<td>2.0</td>
									</tr>
									<tr>
										<td>X_DOMINANT</td>
										<td>0.1</td>
									</tr>
									<tr>
										<td>X_RECESSIVE_HOM_ALT</td>
										<td>0.1</td>
									</tr>
									<tr>
										<td>X_RECESSIVE_COMP_HET</td>
										<td>2.0</td>
									</tr>
									<tr>
										<td>MITOCHONDRIAL</td>
										<td>0.2</td>
									</tr>
									</table>
									<p>The values represent the maximum minor allele frequency in percent (%) permitted for an allele to be considered as a causative candidate under that mode of inheritance. If you just want to analyse a sample under a single inheritance mode, deselect the others.</p>
									<p>For AUTOSOMAL_RECESSIVE or X_RECESSIVE ensure both relevant HOM_ALT and COMP_HET modes are present. In cases where you do not want any cut-offs applied, deselect all.</p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p4.close()">Close</button>
								</ng-template>
								<label for="InheritanceModes">Inheritance Modes <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p4="ngbPopover" [ngbPopover]="popContent4" popoverTitle="Inheritance Modes"></i></label>
							</div>
							<div class="form-group col-md-12 row">
								<h6 class="col-md-12">Section: AUTOSOMAL</h6>
								<div class="form-group col-md-4 col-lg-3">
									<label class="d-block" for="AUTOSOMAL_DOMINANT">DOMINANT</label>
									<input  type="text" class="form-control smallInput" id="AUTOSOMAL_DOMINANT" name="AUTOSOMAL_DOMINANT" [(ngModel)]="settingExomizer.InheritanceModes.AUTOSOMAL_DOMINANT" number #AUTOSOMAL_DOMINANT="ngModel">
									<small class="form-text text-muted danger" *ngIf="AUTOSOMAL_DOMINANT.errors?.number">Error! only numbers Ex: 0.1</small>
								</div>
								<div class="form-group col-md-4 col-lg-3">
									<label class="d-block" for="AUTOSOMAL_RECESSIVE_HOM_ALT">RECESSIVE HOM ALT</label>
									<input  type="text" class="form-control smallInput" id="AUTOSOMAL_RECESSIVE_HOM_ALT" name="AUTOSOMAL_RECESSIVE_HOM_ALT" [(ngModel)]="settingExomizer.InheritanceModes.AUTOSOMAL_RECESSIVE_HOM_ALT" number #AUTOSOMAL_RECESSIVE_HOM_ALT="ngModel">
									<small class="form-text text-muted danger" *ngIf="AUTOSOMAL_RECESSIVE_HOM_ALT.errors?.number">Error! only numbers Ex: 0.1</small>
								</div>
								<div class="form-group col-md-4 col-lg-3">
									<label class="d-block" for="AUTOSOMAL_RECESSIVE_COMP_HET">RECESSIVE COMP HET</label>
									<input  type="text" class="form-control smallInput" id="AUTOSOMAL_RECESSIVE_COMP_HET" name="AUTOSOMAL_RECESSIVE_COMP_HET" [(ngModel)]="settingExomizer.InheritanceModes.AUTOSOMAL_RECESSIVE_COMP_HET" number #AUTOSOMAL_RECESSIVE_COMP_HET="ngModel">
									<small class="form-text text-muted danger" *ngIf="AUTOSOMAL_RECESSIVE_COMP_HET.errors?.number">Error! only numbers Ex: 2.0</small>
								</div>
								<h6 class="col-md-12">Section: X</h6>
								<div class="form-group col-md-4 col-lg-3">
									<label class="d-block" for="X_DOMINANT">DOMINANT</label>
									<input  type="text" class="form-control smallInput" id="X_DOMINANT" name="X_DOMINANT" [(ngModel)]="settingExomizer.InheritanceModes.X_DOMINANT" number #X_DOMINANT="ngModel">
									<small class="form-text text-muted danger" *ngIf="X_DOMINANT.errors?.number">Error! only numbers Ex: 0.1</small>
								</div>
								<div class="form-group col-md-4 col-lg-3">
									<label class="d-block" for="X_RECESSIVE_HOM_ALT">RECESSIVE HOM ALT</label>
									<input  type="text" class="form-control smallInput" id="X_RECESSIVE_HOM_ALT" name="X_RECESSIVE_HOM_ALT" [(ngModel)]="settingExomizer.InheritanceModes.X_RECESSIVE_HOM_ALT" number #X_RECESSIVE_HOM_ALT="ngModel">
									<small class="form-text text-muted danger" *ngIf="X_RECESSIVE_HOM_ALT.errors?.number">Error! only numbers Ex: 0.1</small>
								</div>
								<div class="form-group col-md-4 col-lg-3">
									<label class="d-block" for="X_RECESSIVE_COMP_HET">RECESSIVE COMP HET</label>
									<input  type="text" class="form-control smallInput" id="X_RECESSIVE_COMP_HET" name="X_RECESSIVE_COMP_HET" [(ngModel)]="settingExomizer.InheritanceModes.X_RECESSIVE_COMP_HET" number #X_RECESSIVE_COMP_HET="ngModel">
									<small class="form-text text-muted danger" *ngIf="X_RECESSIVE_COMP_HET.errors?.number">Error! only numbers Ex: 2.0</small>
								</div>
								<h6 class="col-md-12">Section: MITOCHONDRIAL</h6>
								<div class="form-group col-md-3">
									<input  type="text" class="form-control smallInput" id="MITOCHONDRIAL" name="MITOCHONDRIAL" [(ngModel)]="settingExomizer.InheritanceModes.MITOCHONDRIAL" number #MITOCHONDRIAL="ngModel">
									<small class="form-text text-muted danger" *ngIf="MITOCHONDRIAL.errors?.number">Error! only numbers Ex: 0.2</small>
								</div>
							</div>
						</div>
						<h4 class="form-section col-md-12">Macrovariables <i [ngClass]="(showMacrovariables==true)?'ft-chevron-up info':'ft-chevron-down info'" (click)="showMacrovariables=!showMacrovariables"></i></h4>
						<div class="col-md-12 row" *ngIf="showMacrovariables">
							<div class="form-group col-md-3">
								<ng-template #popContent5>
									<p>Select this variable to analyse data from whole genome sequencing.</p>
									<p>Setting it to true activates: {{ '{priorityType: HIPHIVE_PRIORITY, minPriorityScore: 0.501}' }} , adds <a href="https://charite.github.io/software-remm-score.html" target="_blank">REMM</a> to the 'PathogenicitySources' and deselects all 'VariantEffectFilters' (if they have not been edited by the user) to better parse the genome. </p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p5.close()">Close</button></ng-template>
								<label for="IsGenome">Is Genome <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p5="ngbPopover" [ngbPopover]="popContent5" popoverTitle="Is Genome"></i></label>
								<ui-switch class="d-block" id="IsGenome" name="IsGenome" [(ngModel)]="settingExomizer.IsGenome" (change)="isGenomeChangedEvent($event)"></ui-switch>
							</div>
						</div>
						<h4 class="form-section col-md-12">Filters <i [ngClass]="(showFilters==true)?'ft-chevron-up info':'ft-chevron-down info'" (click)="showFilters=!showFilters"></i></h4>
						<div class="col-md-12 row" *ngIf="showFilters">
							<div class="form-group col-md-6">
								<ng-template #popContent6><p>Sources to score variant pathogenicity from.</p>
									<p><a href="https://charite.github.io/software-remm-score.html" target="_blank">REMM</a> is trained on non-coding regulatory regions and is automatically activated by the IsGenome option. <a href="https://cadd.gs.washington.edu/" target="_blank">CADD</a> has been deactivated to alleviate the computation resources. If your case may benefit from using this source, get in touch with us at <a href="mailto:support@foundation29.org">support@foundation29.org</a> and we will reconsider our position. </p>
									<p>Options: <a href="https://genome.cshlp.org/content/12/3/436" target="_blank">POLYPHEN</a>, <a href="https://www.nature.com/articles/nmeth0810-575" target="_blank">MUTATION_TASTER</a>, <a href="https://www.nature.com/articles/nmeth0410-248" target="_blank">SIFT</a>, <a href="https://charite.github.io/software-remm-score.html" target="_blank">REMM</a>.</p>
									<p>Default: POLYPHEN, MUTATION_TASTER, SIFT. </p>
									<p>If you are wondering how to improve this, note that we are too: <a href="https://github.com/exomiser/Exomiser/issues/311" target="_blank">have a look</a></p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p6.close()">Close</button></ng-template>
								<label for="PathogenicitySources">Pathogenicity Sources <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p6="ngbPopover" [ngbPopover]="popContent6" popoverTitle="Pathogenicity Sources"></i></label>
								<mat-select class="form-control" id="PathogenicitySources" name="PathogenicitySources"  [(ngModel)]="settingExomizer.PathogenicitySources" multiple>
									<mat-option value="POLYPHEN">POLYPHEN</mat-option>
									<mat-option value="MUTATION_TASTER">MUTATION_TASTER</mat-option>
									<mat-option value="SIFT">SIFT</mat-option>
								</mat-select>
							</div>
							<div class="form-group col-md-3">
								<ng-template #popContent7>
									<p>If set to true, then all variants wil be kept. Setting this to false will set the filter to fail non-missense variants with pathogenicity scores lower than a score cutoff of 0.5. This filter is meant to be quite permissive.</p>
									<p>Default: false</p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p7.close()">Close</button></ng-template>
								<label for="KeepNonPathogenic">Keep Non Pathogenic <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p7="ngbPopover" [ngbPopover]="popContent7" popoverTitle="Keep Non Pathogenic"></i></label>
								<ui-switch class="d-block" id="KeepNonPathogenic" name="KeepNonPathogenic" [(ngModel)]="settingExomizer.KeepNonPathogenic"></ui-switch>
							</div>
							<div class="form-group col-md-12">
								<ng-template #popContent8>
									<p>Frequency databases you want to use. We recommend the default: all databases</p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p8.close()">Close</button></ng-template>
								<label for="FrequencySources">Frequency Sources <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p8="ngbPopover" [ngbPopover]="popContent8" popoverTitle="Frequency Sources"></i></label>
								<mat-select class="form-control" id="FrequencySources" name="FrequencySources"  [(ngModel)]="settingExomizer.FrequencySources" multiple>
									<mat-option value="THOUSAND_GENOMES">THOUSAND_GENOMES</mat-option>
									<mat-option value="TOPMED">TOPMED</mat-option>
									<mat-option value="UK10K">UK10K</mat-option>
									<mat-option value="ESP_AFRICAN_AMERICAN">ESP_AFRICAN_AMERICAN</mat-option>
									<mat-option value="ESP_EUROPEAN_AMERICAN">ESP_EUROPEAN_AMERICAN</mat-option>
									<mat-option value="ESP_ALL">ESP_ALL</mat-option>
									<mat-option value="EXAC_AFRICAN_INC_AFRICAN_AMERICAN">EXAC_AFRICAN_INC_AFRICAN_AMERICAN</mat-option>
									<mat-option value="EXAC_AMERICAN">EXAC_AMERICAN</mat-option>
									<mat-option value="EXAC_SOUTH_ASIAN">EXAC_SOUTH_ASIAN</mat-option>
									<mat-option value="EXAC_EAST_ASIAN">EXAC_EAST_ASIAN</mat-option>
									<mat-option value="EXAC_FINNISH">EXAC_FINNISH</mat-option>
									<mat-option value="EXAC_NON_FINNISH_EUROPEAN">EXAC_NON_FINNISH_EUROPEAN</mat-option>
									<mat-option value="EXAC_OTHER">EXAC_OTHER</mat-option>
									<mat-option value="GNOMAD_E_AFR">GNOMAD_E_AFR</mat-option>
									<mat-option value="GNOMAD_E_AMR">GNOMAD_E_AMR</mat-option>
									<mat-option value="GNOMAD_E_EAS">GNOMAD_E_EAS</mat-option>
									<mat-option value="GNOMAD_E_FIN">GNOMAD_E_FIN</mat-option>
									<mat-option value="GNOMAD_E_NFE">GNOMAD_E_NFE</mat-option>
									<mat-option value="GNOMAD_E_OTH">GNOMAD_E_OTH</mat-option>
									<mat-option value="GNOMAD_E_SAS">GNOMAD_E_SAS</mat-option>
									<mat-option value="GNOMAD_G_AFR">GNOMAD_G_AFR</mat-option>
									<mat-option value="GNOMAD_G_AMR">GNOMAD_G_AMR</mat-option>
									<mat-option value="GNOMAD_G_EAS">GNOMAD_G_EAS</mat-option>
									<mat-option value="GNOMAD_G_FIN">GNOMAD_G_FIN</mat-option>
									<mat-option value="GNOMAD_G_NFE">GNOMAD_G_NFE</mat-option>
									<mat-option value="GNOMAD_G_OTH">GNOMAD_G_OTH</mat-option>
									<mat-option value="GNOMAD_G_SAS">GNOMAD_G_SAS</mat-option>
								</mat-select>
								<button *ngIf="settingExomizer.FrequencySources.length>0" type="button" class="btn btn-flat btn-danger" (click)="clearValuesFrequencySources()">Clear</button>
							</div>
							<div class="form-group col-md-2">
								<ng-template #popContent9>
									<p>Frequency cutoff of a variant in percentage.</p>
									<p>Frequencies are derived from the databases defined in the FrequencySources section. We recommend a value below 5.0%, depending on the disease. Variants will be removed/failed if they have a frequency higher than the stated percentage in any database defined in the frequencySources section. Not defining this filter will result in all variants having no frequency data, even if the frequencySources contains values.</p>
									<p>Default: 1% </p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p9.close()">Close</button></ng-template>
								<label for="Frequency" style="display: block;">Frequency <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p9="ngbPopover" [ngbPopover]="popContent9" popoverTitle="Frequency"></i></label>
								<input  type="text" class="form-control smallInput" id="Frequency" name="Frequency" [(ngModel)]="settingExomizer.Frequency" number #Frequency="ngModel"><span style="display: inline-block;margin-left: 0.5em;">%</span>
								<small class="form-text text-muted danger" *ngIf="Frequency.errors?.number">Error! only numbers Ex: 2.0</small>
							</div>
							<div class="form-group col-md-3">
								<ng-template #popContent10>
								<p>If true it removes all non-regulatory, non-coding variants over 20Kb from a known gene. Intergenic and upstream variants in known enhancer regions over 20kb from a known gene are associated with genes in their TAD and not effected by this filter. This is an important filter to include when analysing whole-genome data.</p>
								<p>Default: true</p>
								<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p10.close()">Close</button></ng-template>
								<label for="RegulatoryFeatureFilter">Regulatory Feature Filter <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p10="ngbPopover" [ngbPopover]="popContent10" popoverTitle="Regulatory Feature Filter"></i></label>
								<ui-switch class="d-block" id="RegulatoryFeatureFilter" name="RegulatoryFeatureFilter" [(ngModel)]="settingExomizer.RegulatoryFeatureFilter"></ui-switch>
							</div>
							<div class="form-group col-md-12">
								<ng-template #popContent11>
									<p>Define a set of classes you want to remove from the output if you are interested only in specific functional classes of variants.</p>
									<p>Variant effects are generated by <a href="http://charite.github.io/jannovar/" target="_blank">Jannovar</a>. Jannovar uses <a href="http://www.sequenceontology.org/" target="_blank">Sequence Ontology (SO)</a> terms and are listed in their <a href="https://doc-openbio.readthedocs.io/projects/jannovar/en/master/filter.html?highlight=variant%20filter" target="_blank">manual</a>. </p>
									<p>Default: UPSTREAM_GENE_VARIANT, INTERGENIC_VARIANT, REGULATORY_REGION_VARIANT, CODING_TRANSCRIPT_INTRON_VARIANT, NON_CODING_TRANSCRIPT_INTRON_VARIANT, SYNONYMOUS_VARIANT, DOWNSTREAM_GENE_VARIANT, SPLICE_REGION_VARIANT. If this field has not been modified, by the user, all items will be deselected when activating IsGenome </p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p11.close()">Close</button>
								</ng-template>
								<label for="VariantEffectFilters">VariantEffectFilters <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p11="ngbPopover" [ngbPopover]="popContent11" popoverTitle="VariantEffectFilters"></i></label>
								<mat-select class="form-control" id="VariantEffectFilters" name="VariantEffectFilters"  [(ngModel)]="settingExomizer.VariantEffectFilters.remove" multiple (selectionChange)="variantEffectFiltersChanged()">
									<mat-option value="UPSTREAM_GENE_VARIANT">UPSTREAM_GENE_VARIANT</mat-option>
									<mat-option value="INTERGENIC_VARIANT">INTERGENIC_VARIANT</mat-option>
									<mat-option value="REGULATORY_REGION_VARIANT">REGULATORY_REGION_VARIANT</mat-option>
									<mat-option value="CODING_TRANSCRIPT_INTRON_VARIANT">CODING_TRANSCRIPT_INTRON_VARIANT</mat-option>
									<mat-option value="NON_CODING_TRANSCRIPT_INTRON_VARIANT">NON_CODING_TRANSCRIPT_INTRON_VARIANT</mat-option>
									<mat-option value="SYNONYMOUS_VARIANT">SYNONYMOUS_VARIANT</mat-option>
									<mat-option value="DOWNSTREAM_GENE_VARIANT">DOWNSTREAM_GENE_VARIANT</mat-option>
									<mat-option value="SPLICE_REGION_VARIANT">SPLICE_REGION_VARIANT</mat-option>
								</mat-select>
								<button *ngIf="settingExomizer.VariantEffectFilters.remove.length>0" type="button" class="btn btn-flat btn-danger" (click)="clearValuesVariantEffectFilters()">Clear</button>
							</div>
							<div class="form-group col-md-3">
								<ng-template #popContent12>
									<p>Minimum QUAL score of the variant call in VCF file.</p>
									<p>Default: 50.0</p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p12.close()">Close</button></ng-template>
								<label class="d-block" for="MinQuality">Min Call Quality <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p12="ngbPopover" [ngbPopover]="popContent12" popoverTitle="Min Call Quality"></i></label>
								<input  type="text" class="form-control smallInput" id="MinQuality" name="MinQuality" [(ngModel)]="settingExomizer.MinQuality" number #MinQuality="ngModel">
								<small class="form-text text-muted danger" *ngIf="MinQuality.errors?.number">Error! only numbers Ex: 2.0</small>
							</div>
						</div>
						<h4 class="form-section col-md-12">Prioritizers <i [ngClass]="(showPrioritizers==true)?'ft-chevron-up info':'ft-chevron-down info'" (click)="showPrioritizers=!showPrioritizers"></i></h4>
						<!--<div class="form-group col-md-11">
							<label for="Prioritizers">Prioritizers</label>
							<mat-select class="form-control" id="Prioritizers" name="Prioritizers"  [(ngModel)]="settingExomizer.Prioritizers" multiple>
								<mat-option value="hiphive">hiPHIVE (compare phenotypes against all species)</mat-option>
								<mat-option value="phive">PHIVE (compare phenotypes against mouse only)</mat-option>
								<mat-option value="phenix">PhenIX (compare phenotypes against human only)</mat-option>
								<mat-option value="none">None - filter only</mat-option>
							</mat-select>
						</div>-->
						<div class="col-md-12 row" *ngIf="showPrioritizers">
							<div class="form-group col-md-11">
								<ng-template #popContent13>
									<p>Scores genes using phenotype comparisons to human, mouse and fish involving disruption of the gene or nearby genes in the interactome using a Random walk. Deselecting all is the same selecting all.</p>
									<p>If IsGenome is true, the following is passed as additional option: priorityScoreFilter: {{ '{priorityType: HIPHIVE_PRIORITY, minPriorityScore: 0.501}' }}</p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p13.close()">Close</button>
								</ng-template>
								<label for="HiPhivePrioritisers">HiPhive Prioritisers <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p13="ngbPopover" [ngbPopover]="popContent13" popoverTitle="HiPhive Prioritisers"></i></label>
								<mat-select class="form-control" id="HiPhivePrioritisers" name="HiPhivePrioritisers"  [(ngModel)]="settingExomizer.HiPhivePrioritisers" multiple>
									<mat-option value="human">human</mat-option>
									<mat-option value="mouse">mouse</mat-option>
									<mat-option value="fish">fish</mat-option>
									<mat-option value="ppi">ppi</mat-option>
								</mat-select>
							</div>
						</div>
						<h4 class="form-section col-md-12">Input control <i [ngClass]="(showInputControl==true)?'ft-chevron-up info':'ft-chevron-down info'" (click)="showInputControl=!showInputControl"></i></h4>
						<div class="col-md-12 row" *ngIf="showInputControl">
							<div class="row col-md-12 modal-body">
								<ng-template #popContent15>
									<p>List of HPO terms to prime the variant prioritization.</p>
									<p>Example: HP:0001156, HP:0001363, HP:0011304, HP:0010055.</p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p15.close()">Close</button>
								</ng-template>
								<label class="d-block col-md-12" for="ActualSymtoms">Set of Symptoms <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p15="ngbPopover" [ngbPopover]="popContent15" popoverTitle="Set of Symptoms"></i></label>
								<div class="row col-md-12">
									<span class="col-md-3" *ngFor="let hpo of phenotype.data ; let i = index">
										<span>{{i+1}}. {{hpo.name}} - {{hpo.id}}</span><a class="danger" data-original-title="" title="" (click)="confirmDeletePhenotype(i)">
											<i class="ft-x"></i>
										</a>
									</span>
								</div>
								<label class="col-md-12 d-block mt-4" for="AddNewSymtoms">Add New Symptoms</label>
								<ng-template #rt let-r="result" let-t="term">
									{{ r.name}} - {{ r.id}}
								</ng-template>
								<div class="col-md-12 form-group">
									<input #input class="input" type="text" class="form-control mb-3" [(ngModel)]="modelTemp" [ngbTypeahead]="searchSymptom" name="addSymptomsOption2" [resultTemplate]="rt" [inputFormatter]="formatter1" placeholder="Search by sympton name or HPO code" (selectItem)="selected2($event)"/>
								</div>
								<span class="btn btn-primary btn-sm selected" style="margin-right: 0.5em;" *ngFor="let item of selectedItems">
									<span style="color: black !important;">
										{{item.name}} - {{ item.id}}
										<span class="close-selected" (click)="deleteItem(item)">&nbsp;x</span>
									</span>
								</span>
								<div class="col-md-12 center-elements">
									<button *ngIf="!loadingHpoExtractor" type="button" (click)="addSymptomsOption2()" [disabled]="selectedItems.length == 0" class="btn btn-raised btn-primary">{{'diagnosis.Add symptoms' | translate }}</button>
								</div>
							</div>
						</div>
						<h4 class="form-section col-md-12">Output control <i [ngClass]="(showOutputControl==true)?'ft-chevron-up info':'ft-chevron-down info'" (click)="showOutputControl=!showOutputControl"></i></h4>
						<div class="col-md-12 row" *ngIf="showOutputControl">
							<div class="form-group col-md-4">
								<ng-template #popContent14>
									<p>Number of genes to output. Setting it to 0 means to output all. Specify a limit if desired. Default is 50 for the first 50 results</p>
									<button class="pull-right mt-2" style="margin-top: 1em;margin-bottom: 1em;" (click)="p14.close()">Close</button>
								</ng-template>
								<label for="NumGenes">Num Genes <i class="ft-help-circle danger" style="cursor: pointer;" placement="down" #p14="ngbPopover" [ngbPopover]="popContent14" popoverTitle="Num Genes"></i></label>
								<input  type="text" class="form-control" id="NumGenes" name="NumGenes" [(ngModel)]="settingExomizer.NumGenes" digits #NumGenes="ngModel">
								<small class="form-text text-muted danger" *ngIf="NumGenes.errors?.digits">{{'generics.Only integers are allowed' | translate }}</small>
							</div>
							<div class="form-group col-md-4">
								<label for="OutputPassVariantsOnly">Output Pass Variants Only</label>
								<ui-switch class="d-block" id="OutputPassVariantsOnly" name="OutputPassVariantsOnly" [(ngModel)]="settingExomizer.OutputPassVariantsOnly"></ui-switch>
							</div>
							<div class="form-group col-md-4">
								<label for="OutputFormats">OutputFormats</label>
								<mat-select class="form-control" id="OutputFormats" name="OutputFormats"  [(ngModel)]="settingExomizer.OutputFormats" multiple>
									<mat-option [disabled]=true value="HTML">HTML</mat-option>
									<mat-option [disabled]=true value="JSON">JSON</mat-option>
									<mat-option value="TSV_GENE">TSV_GENE</mat-option>
									<mat-option value="TSV_VARIANT">TSV_VARIANT</mat-option>
									<mat-option value="VCF">VCF</mat-option>
								</mat-select>
							</div>
						</div>
						<!--
							<div class="form-group col-md-3">
								<label for="AnalysisMode">AnalysisMode</label>
								<mat-select class="form-control" id="AnalysisMode" name="AnalysisMode"  [(ngModel)]="settingExomizer.AnalysisMode">
									<mat-option value="PASS_ONLY">PASS_ONLY</mat-option>
									<mat-option value="FULL">FULL</mat-option>
								</mat-select>
							</div>
						-->
						<!--<div class="form-group col-md-6">
							<label for="ResultsPrefix">Results Prefix</label>
							<p>{{settingExomizer.ResultsPrefix}}</p>
						</div>-->



					</div>
				</div>
			</form>
		</div>
		<div class="modal-footer">
			<div class="form-actions center" *ngIf="!sending">
					<button type="button" class="btn btn-secondary btn-raised" (click)="cancelSettingsExomiser()">{{'generics.Cancel' | translate }}</button>
					<button type="button" class="btn btn-primary btn-raised" (click)="saveSettingsExomiser()">{{'generics.Save' | translate }}</button>
			</div>
		</div>
</ng-template>

<ng-template #contentSymptomsNcr let-c="close" let-d="dismiss" appendTo="body">
		<div id="idHeader">
			<p *ngIf="infoNcrToSave.ncrVersion != undefined">NCR Version: {{infoNcrToSave.ncrVersion}}</p>
		</div>

		<div class="card" *ngIf="resultTextNcrCopy!=''">
			<div class="row col-md-12">
				<div class="col-md-5">
					<div class="row">
						<div class="col-md-12 center-elements">
							<h4>{{temporalSymptoms.length}} {{'diagnosis.Symptoms' | translate }}</h4>
						</div>
						<table class="col-md-12 table text-center">
							<thead>
								<tr>
									<th style="cursor: pointer;" title="Sort by name." (click)="sortByName();">{{'generics.Name' | translate }}</th>
									<th style="cursor: pointer;" title="Sort by similarity." (click)="sortBySimilarity();">Max. Similarity</th>
									<th># / Apparitions</th>
									<th>Select/deselect</th>
								</tr>
							</thead>
							<tbody>
								<tr *ngFor="let hpo of temporalSymptoms ; let i = index">
									<td><a href="https://monarchinitiative.org/phenotype/{{hpo.id}}" target="_blank" title="{{hpo.name}} --> {{hpo.id}}">{{hpo.name}}</a></td>
									<td>{{hpo.similarity | number}}</td>
									<td>
										<p class="mb-0">#: {{hpo.positions.length}} <span (click)="markAllText(copyResultTextNcr, hpo);"><i class="fa fa-search" style="cursor: pointer;" title="Shows the apparitions in the text."></i></span></p>
										<span *ngFor="let position of hpo.positions ; let j = index">
											<span style="cursor: pointer;" title="Shows the apparitions in the text." (click)="markText(copyResultTextNcr, position[0], position[1])">{{copyResultTextNcr | slice:position[0]:position[1]}} </span>
											<span *ngIf="j<(hpo.positions.length-1)">, </span>
										</span>
									</td>
									<td>
										<button (click)="changeStateSymptom(i)" [ngClass]="(hpo.checked==true)?'btn btn-success mr-1 mb-0 btn-fab':'btn btn-secondary mr-1 mb-0 btn-fab'" [disabled]=hpo.checked href="javascript:void(0)">
											<i class="fa fa-check"></i>
										</button>
										<button (click)="changeStateSymptom(i)" [ngClass]="(hpo.checked==false)?'btn btn-danger mr-1 mb-0 btn-fab':'btn btn-secondary mr-1 mb-0 btn-fab'" [disabled]=!hpo.checked href="javascript:void(0)">
											<i class="fa fa-times"></i>
										</button>
										<!--<a class="danger" data-original-title="" title="" (click)="confirmDeletePhenotype(i)">
											<i class="ft-x"></i>
										</a>-->
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div class="col-md-7">
					<div class="card-body">
							<div class="card-block text-center">
									<div class="form-group">
										<div class="col-md-12 center-elements">
											<h4>Results:</h4>
										</div>
										<div style="text-align: justify;" class="textExtractedNcr" [innerHTML]=resultTextNcrCopy></div>
									</div>
							</div>
					</div>

				</div>
			</div>
	</div>



		<div class="modal-footer">
			<div class="form-actions center" *ngIf="!sending">
					<button type="button" class="btn btn-secondary btn-raised" (click)="c('Close click')">{{'generics.Close' | translate }}</button>
					<button type="button" class="btn btn-primary btn-raised" (click)="saveSymptomsNcr()">{{'generics.Save' | translate }}</button>
			</div>
		</div>
</ng-template>

<ng-template #contentAddTextSymptoms let-c="close" let-d="dismiss" appendTo="body">
		<div id="idHeader">
		</div>

		<div class="content-wrapper">
			<div class="row col-md-12">
				<div class="w-100 row">
					<div class="mt-3 col-md-12">
						<span class="font-medium-2">{{'phenotype.HPO phenotype extractor placeholder' | translate }}</span>
						<p>
							<small class="text-muted">{{'diagnosis.MsgExtractorField' | translate }} </small>
						</p>
					</div>
				</div>
				<button id="openModalSymptomsNcrButton" [hidden]="true" (click)="showPanelSymptomsNcr(contentSymptomsNcr)">.</button>
				<form class="form w-100" (ngSubmit)="onSubmitToExtractor()" #f="ngForm">
					<div class="form-body">
						<div class="row">
							<div [ngClass]="(loadingHpoExtractor==true)?'d-none':'col-md-12'">
								<div class="form-group">
									<label class="pull-right mb-0 btn btn-flat btn-primary" style="text-transform: none;letter-spacing: 0px;cursor: pointer;">
											{{'diagnosis.MsgUploadFileType' | translate }} <input type="file" (change)="onFileChangePDF($event)" style="display: none;">
									</label>
									<textarea class="form-control" style="width:100%;max-height: 30vh;height:30vh;" [(ngModel)]="medicalText" name="medicalText" placeholder="{{'phenotype.HPO phenotype extractor placeholder' | translate }}"></textarea>
									<a *ngIf="medicalText.trim().length > 0" class="btn btn-outline-danger mb-0 mt-1" (click)="deleteText()" href="javascript:void(0)"><i class="fa fa-trash"></i></a>
									<span *ngIf="parserObject.file" class="pull-right">{{'parser.msgOcrInline' | translate }}: <a (click)="parserObject.parserStrategy='OcrInline'; callParser()" href="javascript:void(0)">{{'parser.Advanced extraction' | translate }}</a></span>
								</div>
							</div>
							<div class="col-md-12 center-elements">
								<button *ngIf="!loadingHpoExtractor" type="button" type="submit" [disabled]="medicalText.trim().length <= 5" class="mt-2 font-large-1 btn btn-primary btn-raised">{{'phenotype.Get symptoms' | translate }}</button>
								<button *ngIf="!loadingHpoExtractor && resultTextNcr!='' && medicalText== ''" type="button" class="btn btn-flat btn-primary" (click)="showPanelSymptomsNcr(contentSymptomsNcr)">{{'diagnosis.Edit last extraction' | translate }}</button>
							</div>
							<div class="row col-md-12 center-elements">
									<p class="col-md-12 centerSpinner" *ngIf="loadingHpoExtractor"><i class="fa fa-spinner fa-spin fa-3x fa-fw pink"></i></p>
							</div>
						</div>
					</div>
				</form>
			</div>
	</div>
		<div class="modal-footer">
			<div class="form-actions center" *ngIf="!sending">
					<button type="button" class="btn btn-secondary btn-raised" (click)="c('Close click')">{{'generics.Close' | translate }}</button>
			</div>
		</div>
</ng-template>

<ng-template #contentFeedback let-c="close" let-d="dismiss" appendTo="body">
		<div id="idHeader">
		</div>

		<div class="content-wrapper card">
			<div class="row col-md-12">
				<div class="mb-4">
					<form class="form" #fWeight="ngForm">
						<div class="form-body">
							<div class="row">
								<div class="col-md-12">
									<div class="form-group">
										<label for="hasDiagnosis">{{'diagnosis.Has Diagnosis' | translate }}</label>
										<p>
											<ui-switch id="hasDiagnosis" name="hasDiagnosis" [(ngModel)]="diagnosisInfo.hasDiagnosis"></ui-switch>
										</p>
									</div>
								</div>
								<div class="col-md-6" *ngIf="diagnosisInfo.hasDiagnosis">
									<div class="form-group">
										<label for="previousDiagnosis">{{'diagnosis.Previous Diagnosis' | translate }}</label>
										<input type="text" id="previousDiagnosis" class="form-control"  name="previousDiagnosis" [(ngModel)]="diagnosisInfo.previousDiagnosis">
									</div>
								</div>
								<div class="col-md-6" *ngIf="diagnosisInfo.hasDiagnosis">
									<div class="form-group">
										<label for="identifiedGene">{{'diagnosis.Identified Gene' | translate }}</label>
										<input type="text" id="identifiedGene" class="form-control"  name="identifiedGene" [(ngModel)]="diagnosisInfo.identifiedGene">
									</div>
								</div>
								<div class="col-md-12">
									<div class="form-group">
										<label for="evaluation">{{'diagnosis.Evaluation' | translate }}</label>
										<select id="evaluation" name="evaluation" class="form-control"  [(ngModel)]="diagnosisInfo.evaluation">
											<option value="The condition appears among the first 5 suggested results">{{'diagnosis.The condition appears among the first 5 suggested results' | translate }}</option>
											<option value="The condition appears in the list of suggested results">{{'diagnosis.The condition appears in the list of suggested results' | translate }}</option>
											<option value="The condition does not appear in the list of suggested results">{{'diagnosis.The condition does not appear in the list of suggested results' | translate }}</option>
										</select>
									</div>
								</div>
								<div class="col-md-12">
									<div class="form-group">
										<label for="notes">{{'generics.notes' | translate }}</label>
										<textarea name="notes" class="form-control" style="width:100%;height:30vh;max-height: 30vh;" [(ngModel)]="diagnosisInfo.notes" name="notes"></textarea>
									</div>
								</div>
							</div>
						</div>
					</form>


				</div>
			</div>
	</div>
		<div class="modal-footer">
			<div class="form-actions center" *ngIf="!sending">
				<button type="button" class="btn btn-secondary btn-raised" (click)="c('Close click')">{{'generics.Close' | translate }}</button>
				<button type="button" class="btn btn-raised btn-primary" (click)="saveNotes()">{{'diagnosis.Save notes' | translate }}</button>
			</div>
		</div>
</ng-template>

<ng-template #contentSelectVcf let-c="close" let-d="dismiss" appendTo="body">
		<div id="idHeader">
		</div>

		<div class="content-wrapper card">
			<div class="row col-md-12">
				<div class="mb-4">
					<table class="table text-center table-responsive">
						<thead>
							<tr>
								<th>VCF file</th>
								<th>{{'generics.Options' | translate }}</th>
							</tr>
						</thead>
						<tbody>
							<tr *ngFor="let onefile of filesVcf; let i = index">
								<td *ngIf="onefile.name == filename" style="word-wrap: anywhere;">
									<span *ngIf="filesVcf.length>1" class="badge bg-secondary text-white">Selected</span> {{onefile.name}}
								</td>
								<td *ngIf="onefile.name != filename" style="word-wrap: anywhere;">
									{{onefile.name}}
								</td>
								<td>
									<a *ngIf="onefile.name != filename" class="btn btn-outline-primary" (click)="selectVcfAsDefault(onefile.name);" href="javascript:void(0)">Select</a>
									<a class="btn btn-outline-danger" (click)="deleteVcfFile(onefile.name,i);" href="javascript:void(0)">Delete</a>
									<!--<a class="danger" data-original-title="" title="" (click)="deleteVcfFile(onefile.name,i)">
										<i class="ft-x"></i>
									</a>-->
								</td>
							</tr>
						</tbody>
					</table>


				</div>
			</div>
	</div>
		<div class="modal-footer">
			<div class="form-actions center" *ngIf="!sending">
				<button type="button" class="btn btn-secondary btn-raised" (click)="c('Close click')">{{'generics.Close' | translate }}</button>
				<button type="button" class="btn btn-raised btn-primary" (click)="launchExomizerOldVcf()">{{'diagnosis.Reanalyze' | translate }}</button>
			</div>
		</div>
</ng-template>

<ng-template #contentSeeSymptomsOfDisease let-c="close" let-d="dismiss" appendTo="body">
		<div id="idHeader">
		</div>

		<div class="content-wrapper mt-2">
			<div class="row col-md-12">
				<div class="row mb-4">
					<div class="col-md-12">
						<h4><a href="https://monarchinitiative.org/disease/{{actualProposedDisease.name.id}}" target="_blank" rel="tooltip" title="{{actualProposedDisease.name.id}}">{{actualProposedDisease.name.label | titlecase}}</a></h4>
					</div>
					<div class="col-md-12 mt-2">
						<h5>Genes:</h5>
					</div>
					<div class="col-md-12 mb-2">

						<span *ngIf="actualProposedDisease.genes === undefined">
							<span *ngIf="actualProposedDisease.name.infogene !== undefined">
								No information found in Monarch's MONDO disease database. Consulting genecards instead. The link may not work.
								<a href="{{actualProposedDisease.name.infogene}}" target="_blank" rel="tooltip" title="{{actualProposedDisease.name.infogene}}">More info</a>
							</span>
							<span *ngIf="actualProposedDisease.name.infogene === undefined">
								{{actualProposedDisease.name.label}}
							</span>

						</span>
						<span *ngIf="actualProposedDisease.genes !== undefined">
							<!--<span *ngFor="let gen of actualProposedDisease.genes ; let j = index">-->
							<span *ngFor="let gen of listOfGenes ; let j = index">
								<a *ngIf="gen.checked && gen.importance=='1'" style="color: #0CC27E;" class="font-medium-3" href="https://www.genecards.org/cgi-bin/carddisp.pl?gene={{gen.gen}}#diseases" target="_blank" rel="tooltip" title="The gene {{gen.gen}} appears in the Exomiser results. Click to see more information."> {{gen.gen}}</a>
								<a *ngIf="gen.checked && gen.importance!='1'" style="color: #acae63;" class="font-medium-1" href="https://www.genecards.org/cgi-bin/carddisp.pl?gene={{gen.gen}}#diseases" target="_blank" rel="tooltip" title="The gene {{gen.gen}} appears in the Phenolyzer results. Click to see more information."> {{gen.gen}}</a>
								<a *ngIf="!gen.checked" style="color: #f9423a;" class="font-small-3" href="https://www.genecards.org/cgi-bin/carddisp.pl?gene={{gen.gen}}#diseases" target="_blank" rel="tooltip" title=" Gene {{gen.gen}}. Click to see more information"> {{gen.gen}}</a>
								<span *ngIf="j<(actualProposedDisease.genes.length-1)">, </span>
							</span>
						</span>
					</div>
					<div class="col-md-12 mt-3 mb-2">
						<h5 class="d-inline">{{'diagnosis.Symptoms' | translate }}: {{listOfSymptoms.length}}</h5>
					</div>
					<div class="leftAlign row col-md-12 mb-2 ml-2">
						<div class="row col-lg-4 col-md-6 col-sm-12" style="min-height: 5em;" *ngFor="let hpo of listOfSymptoms ; let i = index">
							<div class="col-md-7 col-sm-6">
								<a (click)="openLinkMonarch(hpo.id, $event)" href="javascript:void(0)" title="{{hpo.def}}. {{hpo.comment}} " >{{hpo.name}}</a>
							</div>
							<div class="col-md-5 col-sm-6">
								<button (click)="changeStateDiseaseSymptom(i)" title="Has got the symptom" [ngClass]="(hpo.checked==true)?'btn btn-success btn-sm mr-1 mb-0 btn-fab':'btn btn-secondary btn-sm mr-1 mb-0 btn-fab'" [disabled]=hpo.checked style="float:left;" href="javascript:void(0)">
									<i class="fa fa-check"></i>
								</button>
								<button (click)="changeStateDiseaseSymptom(i)" title="Do not have the symptom" [ngClass]="(hpo.checked==false)?'btn btn-danger btn-sm mr-1 mb-0 btn-fab':'btn btn-secondary btn-sm mr-1 mb-0 btn-fab'" [disabled]=!hpo.checked style="float:left;" href="javascript:void(0)">
									<i class="fa fa-times"></i>
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
	</div>
		<div class="modal-footer">
			<div class="form-actions center" *ngIf="!sending">
				<button type="button" class="btn btn-secondary btn-raised" (click)="c('Close click')">{{'generics.Close' | translate }}</button>
				<button type="button" class="btn btn-raised btn-primary" (click)="saveSymptomsOfDisease()">{{'generics.Save' | translate }}</button>
			</div>
		</div>
</ng-template>

<ng-template #contentFilterDiseases let-c="close" let-d="dismiss" appendTo="body">
	<div class="modal-header" id="idHeader">
			<h4 class="modal-title">{{'diagnosis.Filter diseases' | translate }}</h4>
			<!--<button type="button" class="close" aria-label="Close" (click)="c('Close click')">
				<span aria-hidden="true">&times;</span>
			</button>-->
	</div>
	<div class="content-wrapper mt-3 pr-0">
		<div class="row col-md-12 mb-4 pr-0">

			<mat-accordion class="col-md-4 mt-3 pl-0 pr-0">
				<mat-expansion-panel [expanded]="false" *ngIf="!loadingPatients && patients.length>0">
					<mat-expansion-panel-header>
						<mat-panel-title>
							{{'diagnosis.List of case symptoms' | translate }}
						</mat-panel-title>
					</mat-expansion-panel-header>
					<div class="row col-md-12 pr-0">
						<span class="row col-md-12 mb-2 pr-0" *ngFor="let symptom of phenotype.data ; let k = index" >
							<span class="col-md-6 pr-0">
								<a (click)="openLinkMonarch(symptom.id, $event)" href="javascript:void(0)" title="{{symptom.def}}. {{symptom.comment}} " >{{symptom.name}}</a>
							</span>
							<span class="col-md-6 pr-0 mt-03">
								<button (click)="addToo(k, false)" class="ml-1 btn btn-danger btn-sm btn-fab" title="Add to 'Exclude diseases with these symptoms'" style="margin-bottom: 0; float: right;">
									<i class="fa fa-minus"></i>
								</button>
								<button (click)="addToo(k, true)" class="btn btn-success btn-sm btn-fab" title="Add to 'Include diseases with these symptoms'" style="margin-bottom: 0; float: right;">
									<i class="fa fa-plus"></i>
								</button>
							</span>
						</span>
					</div>
				</mat-expansion-panel>
				<mat-expansion-panel>
					<mat-expansion-panel-header>
						<mat-panel-title>
							{{'diagnosis.More symptoms' | translate }}
						</mat-panel-title>
					</mat-expansion-panel-header>
					<div class="col-md-12">
						<ng-template #rt let-r="result" let-t="term">
							{{ r.name}}
						</ng-template>
						<div class="form-group">
							<input #input class="input" type="text" class="form-control mb-3" [(ngModel)]="modelTemp" [ngbTypeahead]="searchSymptom" name="addSymptomsOption1" [resultTemplate]="rt" [inputFormatter]="formatter1" placeholder="{{'diagnosis.Search for symptoms' | translate }}" (selectItem)="selected3($event)"/>
						</div>
					</div>
						<!--<span class="mr-1 mt-1">Selected:</span>
						<span *ngIf="modelRadio2 == '1'">Include diseases with these symptoms</span>
						<span *ngIf="modelRadio2 == '2'">Exclude diseases with these symptoms</span>-->
					<div class="row col-md-12">
						<span class="col-md-8">
							<span>
								{{tempSymptom.name}} <span *ngIf="tempSymptom.name" class="close-selected" (click)="deleteTempSymptom()"><i class="fa fa-trash"></i></span>
							</span>
						</span>
						<span class="col-md-4">
							<div class="btn-group btn-group-toggle" *ngIf="tempSymptom.name" ngbRadioGroup name="radioBasic" [(ngModel)]="modelRadio2" (change)="addSymptomToList()">
								<label ngbButtonLabel class="btn-raised btn-success " style="cursor: pointer;" title="Add to 'Include diseases with these symptoms'">
									<input ngbButton type="radio" [value]="1"><i class="fa fa-plus"></i>

								</label>
								<label ngbButtonLabel class="btn-raised btn-danger ml-1" style="cursor: pointer;" title="Add to 'Exclude diseases with these symptoms'">
										<input ngbButton type="radio" [value]="2"><i class="fa fa-minus"></i>
								</label>
							</div>
						</span>
					</div>
				</mat-expansion-panel>
			</mat-accordion>
			<div class="col-md-4 mt-3 pr-0">
				<h5><b><i class="fa fa-plus" style="color: #0CC27E !important"></i> Include diseases with these symptoms</b></h5>
				<p *ngIf="selectedItemsFilter.length == 0">{{'diagnosis.No symptoms' | translate }}</p>
				<div class="row col-md-12 pl-0 pr-0" *ngFor="let item of selectedItemsFilter ; let i = index">
					<div *ngIf="item.checked" class="row col-md-12 mt-2 pr-0">
						<span class="col-md-10">
							{{item.name}}
						</span>
						<span class="col-md-2 mt-03">
							<span style="color: black !important;cursor: pointer;">
								<span class="close-selected" (click)="deleteFilter(item)"><i class="fa fa-trash"></i></span>
							</span>
						</span>
						<!--<span class="col-md-2 pr-0 mt-03">
							<span style="float: right;">
							<button (click)="changeStateFilterSymptom(i)" [ngClass]="(item.checked==false)?'btn btn-secondary btn-sm mr-1 mb-0 btn-fab':'btn btn-danger btn-sm mr-1 mb-0 btn-fab'" [disabled]=!item.checked href="javascript:void(0)" title="Move to 'exclude diseases with these symptoms'">
								<i class="fa fa-minus"></i>
							</button>
							</span>
						</span>-->
					</div>
				</div>
			</div>
			<div class="col-md-4 mt-3 pr-0">
				<h5><b><i class="fa fa-minus" style="color: #f9423a !important"></i> Exclude diseases with these symptoms</b></h5>
				<p *ngIf="selectedItemsFilter.length == 0">{{'diagnosis.No symptoms' | translate }}</p>
				<div class="row col-md-12 pl-0 pr-0" *ngFor="let item of selectedItemsFilter ; let i = index">
					<div *ngIf="!item.checked" class="row col-md-12 mt-2 pr-0">
						<!--<span class="col-md-2 mt-03">
							<span style="float: left;">
							<button (click)="changeStateFilterSymptom(i)" [ngClass]="(item.checked==true)?'btn btn-secondary btn-sm mr-1 mb-0 btn-fab':'btn btn-success btn-sm mr-1 mb-0 btn-fab'" [disabled]=item.checked href="javascript:void(0)" title="Move to 'include diseases with these symptoms'">
								<i class="fa fa-plus"></i>
							</button>
							</span>
						</span>-->
						<span class="col-md-10 pr-0">
							{{item.name}}
						</span>
						<span class="col-md-2 mt-03">
							<span style="color: black !important;cursor: pointer;">
								<span class="close-selected" (click)="deleteFilter(item)"><i class="fa fa-trash"></i></span>
							</span>
						</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<div class="form-actions center" *ngIf="!sending">
			<button *ngIf="selectedItemsFilter.length>0" type="button" class="btn btn-secondary btn-raised" (click)="removeFilters()">{{'diagnosis.Remove filters' | translate }}</button>
			<button type="button" class="btn btn-raised btn-primary" (click)="applyFilters()">{{'diagnosis.Apply filters' | translate }}</button>
		</div>
	</div>
</ng-template>

<ng-template #contentDownloadFiles let-c="close" let-d="dismiss" appendTo="body">
		<div id="idHeader">
		</div>

		<div class="content-wrapper card">
			<div class="row col-md-12">
				<div class="mb-4">
					<table class="table text-center table-responsive">
						<thead>
							<tr>
								<th>File</th>
								<th>{{'generics.Date' | translate }}</th>
								<th>{{'generics.Options' | translate }}</th>
							</tr>
						</thead>
						<tbody>
							<tr *ngFor="let onefile of listPatientFiles; let i = index">
								<td style="word-wrap: anywhere;">
									<span *ngIf="onefile.origenFile != undefined">
										{{onefile.origenFile.simplename}}
									</span>
									<span *ngIf="onefile.origenFile == undefined">
										Plain text
									</span>
								</td>
								<td *ngIf="onefile.origenFile != undefined">{{onefile.origenFile.lastModified | date:'medium'}}</td>
								<td *ngIf="onefile.origenFile == undefined">{{onefile.ncrResults.lastModified | date:'medium'}}</td>
								<td>
									<p *ngIf="onefile.origenFile != undefined"><a href="{{accessToken.blobAccountUrl}}{{accessToken.containerName}}/{{onefile.origenFile.name}}{{accessToken.sasToken}}" target="_blank" download>Download original file</a></p>
									<p *ngIf="onefile.ncrResults.ncrresult"><a href="javascript:void(0)" (click)="openNcrResult(onefile.ncrResults.name);">View result NCR</a></p>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<div class="modal-footer">
			<div class="form-actions center" *ngIf="!sending">
				<button type="button" class="btn btn-secondary btn-raised" (click)="c('Close click')">{{'generics.Close' | translate }}</button>
			</div>
		</div>
</ng-template>
